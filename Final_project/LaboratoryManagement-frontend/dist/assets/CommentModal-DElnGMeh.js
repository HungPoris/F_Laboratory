import{t as e}from"./loader-circle-CGh2Y_RS.js";import{$ as t,A as n,G as r,Q as i,S as a,W as o,X as s,Y as c,Z as l,et as u,k as d,o as f,tt as p}from"./index-BK-GGJM4.js";var m=a(`ellipsis-vertical`,[[`circle`,{cx:`12`,cy:`12`,r:`1`,key:`41hilf`}],[`circle`,{cx:`12`,cy:`5`,r:`1`,key:`gxeob9`}],[`circle`,{cx:`12`,cy:`19`,r:`1`,key:`lyex9k`}]]),h=s(((e,n)=>{(function(t){if(typeof e==`object`&&n!==void 0)n.exports=t();else if(typeof define==`function`&&define.amd)define([],t);else{var r=typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:this;r.SockJS=t()}})(function(){return(function(){function e(n,r,i){function a(s,c){if(!r[s]){if(!n[s]){var l=typeof t==`function`&&t;if(!c&&l)return l(s,!0);if(o)return o(s,!0);var u=Error(`Cannot find module '`+s+`'`);throw u.code=`MODULE_NOT_FOUND`,u}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t||e)},d,d.exports,e,n,r,i)}return r[s].exports}for(var o=typeof t==`function`&&t,s=0;s<i.length;s++)a(i[s]);return a}return e})()({1:[function(e,t,n){(function(n){(function(){var r=e(`./transport-list`);t.exports=e(`./main`)(r),`_sockjs_onload`in n&&setTimeout(n._sockjs_onload,1)}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"./main":14,"./transport-list":16}],2:[function(e,t,n){var r=e(`inherits`),i=e(`./event`);function a(){i.call(this),this.initEvent(`close`,!1,!1),this.wasClean=!1,this.code=0,this.reason=``}r(a,i),t.exports=a},{"./event":4,inherits:57}],3:[function(e,t,n){var r=e(`inherits`),i=e(`./eventtarget`);function a(){i.call(this)}r(a,i),a.prototype.removeAllListeners=function(e){e?delete this._listeners[e]:this._listeners={}},a.prototype.once=function(e,t){var n=this,r=!1;function i(){n.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}this.on(e,i)},a.prototype.emit=function(){var e=arguments[0],t=this._listeners[e];if(t){for(var n=arguments.length,r=Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].apply(this,r)}},a.prototype.on=a.prototype.addListener=i.prototype.addEventListener,a.prototype.removeListener=i.prototype.removeEventListener,t.exports.EventEmitter=a},{"./eventtarget":5,inherits:57}],4:[function(e,t,n){function r(e){this.type=e}r.prototype.initEvent=function(e,t,n){return this.type=e,this.bubbles=t,this.cancelable=n,this.timeStamp=+new Date,this},r.prototype.stopPropagation=function(){},r.prototype.preventDefault=function(){},r.CAPTURING_PHASE=1,r.AT_TARGET=2,r.BUBBLING_PHASE=3,t.exports=r},{}],5:[function(e,t,n){function r(){this._listeners={}}r.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]);var n=this._listeners[e];n.indexOf(t)===-1&&(n=n.concat([t])),this._listeners[e]=n},r.prototype.removeEventListener=function(e,t){var n=this._listeners[e];if(n){var r=n.indexOf(t);if(r!==-1){n.length>1?this._listeners[e]=n.slice(0,r).concat(n.slice(r+1)):delete this._listeners[e];return}}},r.prototype.dispatchEvent=function(){var e=arguments[0],t=e.type,n=arguments.length===1?[e]:Array.apply(null,arguments);if(this[`on`+t]&&this[`on`+t].apply(this,n),t in this._listeners)for(var r=this._listeners[t],i=0;i<r.length;i++)r[i].apply(this,n)},t.exports=r},{}],6:[function(e,t,n){var r=e(`inherits`),i=e(`./event`);function a(e){i.call(this),this.initEvent(`message`,!1,!1),this.data=e}r(a,i),t.exports=a},{"./event":4,inherits:57}],7:[function(e,t,n){var r=e(`./utils/iframe`);function i(e){this._transport=e,e.on(`message`,this._transportMessage.bind(this)),e.on(`close`,this._transportClose.bind(this))}i.prototype._transportClose=function(e,t){r.postMessage(`c`,JSON.stringify([e,t]))},i.prototype._transportMessage=function(e){r.postMessage(`t`,e)},i.prototype._send=function(e){this._transport.send(e)},i.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},t.exports=i},{"./utils/iframe":47}],8:[function(e,t,n){(function(n){(function(){var r=e(`./utils/url`),i=e(`./utils/event`),a=e(`./facade`),o=e(`./info-iframe-receiver`),s=e(`./utils/iframe`),c=e(`./location`),l=function(){};n.env.NODE_ENV!==`production`&&(l=e(`debug`)(`sockjs-client:iframe-bootstrap`)),t.exports=function(e,t){var n={};t.forEach(function(e){e.facadeTransport&&(n[e.facadeTransport.transportName]=e.facadeTransport)}),n[o.transportName]=o;var u;e.bootstrap_iframe=function(){var t;s.currentWindowId=c.hash.slice(1),i.attachEvent(`message`,function(i){if(i.source===parent&&(u===void 0&&(u=i.origin),i.origin===u)){var o;try{o=JSON.parse(i.data)}catch{l(`bad json`,i.data);return}if(o.windowId===s.currentWindowId)switch(o.type){case`s`:var d;try{d=JSON.parse(o.data)}catch{l(`bad json`,o.data);break}var f=d[0],p=d[1],m=d[2],h=d[3];if(l(f,p,m,h),f!==e.version)throw Error(`Incompatible SockJS! Main site uses: "`+f+`", the iframe: "`+e.version+`".`);if(!r.isOriginEqual(m,c.href)||!r.isOriginEqual(h,c.href))throw Error(`Can't connect to different domain from within an iframe. (`+c.href+`, `+m+`, `+h+`)`);t=new a(new n[p](m,h));break;case`m`:t._send(o.data);break;case`c`:t&&t._close(),t=null;break}}}),s.postMessage(`s`)}}}).call(this)}).call(this,{env:{}})},{"./facade":7,"./info-iframe-receiver":10,"./location":13,"./utils/event":46,"./utils/iframe":47,"./utils/url":52,debug:55}],9:[function(e,t,n){(function(n){(function(){var r=e(`events`).EventEmitter,i=e(`inherits`),a=e(`./utils/object`),o=function(){};n.env.NODE_ENV!==`production`&&(o=e(`debug`)(`sockjs-client:info-ajax`));function s(e,t){r.call(this);var n=this,i=+new Date;this.xo=new t(`GET`,e),this.xo.once(`finish`,function(e,t){var r,s;if(e===200){if(s=+new Date-i,t)try{r=JSON.parse(t)}catch{o(`bad json`,t)}a.isObject(r)||(r={})}n.emit(`finish`,r,s),n.removeAllListeners()})}i(s,r),s.prototype.close=function(){this.removeAllListeners(),this.xo.close()},t.exports=s}).call(this)}).call(this,{env:{}})},{"./utils/object":49,debug:55,events:3,inherits:57}],10:[function(e,t,n){var r=e(`inherits`),i=e(`events`).EventEmitter,a=e(`./transport/sender/xhr-local`),o=e(`./info-ajax`);function s(e){var t=this;i.call(this),this.ir=new o(e,a),this.ir.once(`finish`,function(e,n){t.ir=null,t.emit(`message`,JSON.stringify([e,n]))})}r(s,i),s.transportName=`iframe-info-receiver`,s.prototype.close=function(){this.ir&&=(this.ir.close(),null),this.removeAllListeners()},t.exports=s},{"./info-ajax":9,"./transport/sender/xhr-local":37,events:3,inherits:57}],11:[function(e,t,n){(function(n,r){(function(){var i=e(`events`).EventEmitter,a=e(`inherits`),o=e(`./utils/event`),s=e(`./transport/iframe`),c=e(`./info-iframe-receiver`),l=function(){};n.env.NODE_ENV!==`production`&&(l=e(`debug`)(`sockjs-client:info-iframe`));function u(e,t){var n=this;i.call(this);var a=function(){var r=n.ifr=new s(c.transportName,t,e);r.once(`message`,function(e){if(e){var t;try{t=JSON.parse(e)}catch{l(`bad json`,e),n.emit(`finish`),n.close();return}var r=t[0],i=t[1];n.emit(`finish`,r,i)}n.close()}),r.once(`close`,function(){n.emit(`finish`),n.close()})};r.document.body?a():o.attachEvent(`load`,a)}a(u,i),u.enabled=function(){return s.enabled()},u.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},t.exports=u}).call(this)}).call(this,{env:{}},typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"./info-iframe-receiver":10,"./transport/iframe":22,"./utils/event":46,debug:55,events:3,inherits:57}],12:[function(e,t,n){(function(n){(function(){var r=e(`events`).EventEmitter,i=e(`inherits`),a=e(`./utils/url`),o=e(`./transport/sender/xdr`),s=e(`./transport/sender/xhr-cors`),c=e(`./transport/sender/xhr-local`),l=e(`./transport/sender/xhr-fake`),u=e(`./info-iframe`),d=e(`./info-ajax`),f=function(){};n.env.NODE_ENV!==`production`&&(f=e(`debug`)(`sockjs-client:info-receiver`));function p(e,t){f(e);var n=this;r.call(this),setTimeout(function(){n.doXhr(e,t)},0)}i(p,r),p._getReceiver=function(e,t,n){return n.sameOrigin?new d(t,c):s.enabled?new d(t,s):o.enabled&&n.sameScheme?new d(t,o):u.enabled()?new u(e,t):new d(t,l)},p.prototype.doXhr=function(e,t){var n=this,r=a.addPath(e,`/info`);f(`doXhr`,r),this.xo=p._getReceiver(e,r,t),this.timeoutRef=setTimeout(function(){f(`timeout`),n._cleanup(!1),n.emit(`finish`)},p.timeout),this.xo.once(`finish`,function(e,t){f(`finish`,e,t),n._cleanup(!0),n.emit(`finish`,e,t)})},p.prototype._cleanup=function(e){f(`_cleanup`),clearTimeout(this.timeoutRef),this.timeoutRef=null,!e&&this.xo&&this.xo.close(),this.xo=null},p.prototype.close=function(){f(`close`),this.removeAllListeners(),this._cleanup(!1)},p.timeout=8e3,t.exports=p}).call(this)}).call(this,{env:{}})},{"./info-ajax":9,"./info-iframe":11,"./transport/sender/xdr":34,"./transport/sender/xhr-cors":35,"./transport/sender/xhr-fake":36,"./transport/sender/xhr-local":37,"./utils/url":52,debug:55,events:3,inherits:57}],13:[function(e,t,n){(function(e){(function(){t.exports=e.location||{origin:`http://localhost:80`,protocol:`http:`,host:`localhost`,port:80,href:`http://localhost/`,hash:``}}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{}],14:[function(e,t,n){(function(n,r){(function(){e(`./shims`);var i=e(`url-parse`),a=e(`inherits`),o=e(`./utils/random`),s=e(`./utils/escape`),c=e(`./utils/url`),l=e(`./utils/event`),u=e(`./utils/transport`),d=e(`./utils/object`),f=e(`./utils/browser`),p=e(`./utils/log`),m=e(`./event/event`),h=e(`./event/eventtarget`),g=e(`./location`),_=e(`./event/close`),v=e(`./event/trans-message`),y=e(`./info-receiver`),b=function(){};n.env.NODE_ENV!==`production`&&(b=e(`debug`)(`sockjs-client:main`));var x;function S(e,t,n){if(!(this instanceof S))return new S(e,t,n);if(arguments.length<1)throw TypeError(`Failed to construct 'SockJS: 1 argument required, but only 0 present`);h.call(this),this.readyState=S.CONNECTING,this.extensions=``,this.protocol=``,n||={},n.protocols_whitelist&&p.warn(`'protocols_whitelist' is DEPRECATED. Use 'transports' instead.`),this._transportsWhitelist=n.transports,this._transportOptions=n.transportOptions||{},this._timeout=n.timeout||0;var r=n.sessionId||8;if(typeof r==`function`)this._generateSessionId=r;else if(typeof r==`number`)this._generateSessionId=function(){return o.string(r)};else throw TypeError(`If sessionId is used in the options, it needs to be a number or a function.`);this._server=n.server||o.numberString(1e3);var a=new i(e);if(!a.host||!a.protocol)throw SyntaxError(`The URL '`+e+`' is invalid`);if(a.hash)throw SyntaxError(`The URL must not contain a fragment`);if(a.protocol!==`http:`&&a.protocol!==`https:`)throw SyntaxError(`The URL's scheme must be either 'http:' or 'https:'. '`+a.protocol+`' is not allowed.`);var s=a.protocol===`https:`;if(g.protocol===`https:`&&!s&&!c.isLoopbackAddr(a.hostname))throw Error(`SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS`);t?Array.isArray(t)||(t=[t]):t=[];var l=t.sort();l.forEach(function(e,t){if(!e)throw SyntaxError(`The protocols entry '`+e+`' is invalid.`);if(t<l.length-1&&e===l[t+1])throw SyntaxError(`The protocols entry '`+e+`' is duplicated.`)});var u=c.getOrigin(g.href);this._origin=u?u.toLowerCase():null,a.set(`pathname`,a.pathname.replace(/\/+$/,``)),this.url=a.href,b(`using url`,this.url),this._urlInfo={nullOrigin:!f.hasDomain(),sameOrigin:c.isOriginEqual(this.url,g.href),sameScheme:c.isSchemeEqual(this.url,g.href)},this._ir=new y(this.url,this._urlInfo),this._ir.once(`finish`,this._receiveInfo.bind(this))}a(S,h);function C(e){return e===1e3||e>=3e3&&e<=4999}S.prototype.close=function(e,t){if(e&&!C(e))throw Error(`InvalidAccessError: Invalid code`);if(t&&t.length>123)throw SyntaxError(`reason argument has an invalid length`);this.readyState===S.CLOSING||this.readyState===S.CLOSED||this._close(e||1e3,t||`Normal closure`,!0)},S.prototype.send=function(e){if(typeof e!=`string`&&(e=``+e),this.readyState===S.CONNECTING)throw Error(`InvalidStateError: The connection has not been established yet`);this.readyState===S.OPEN&&this._transport.send(s.quote(e))},S.version=e(`./version`),S.CONNECTING=0,S.OPEN=1,S.CLOSING=2,S.CLOSED=3,S.prototype._receiveInfo=function(e,t){if(b(`_receiveInfo`,t),this._ir=null,!e){this._close(1002,`Cannot connect to server`);return}this._rto=this.countRTO(t),this._transUrl=e.base_url?e.base_url:this.url,e=d.extend(e,this._urlInfo),b(`info`,e),this._transports=x.filterToEnabled(this._transportsWhitelist,e).main,b(this._transports.length+` enabled transports`),this._connect()},S.prototype._connect=function(){for(var e=this._transports.shift();e;e=this._transports.shift()){if(b(`attempt`,e.transportName),e.needBody&&(!r.document.body||r.document.readyState!==void 0&&r.document.readyState!==`complete`&&r.document.readyState!==`interactive`)){b(`waiting for body`),this._transports.unshift(e),l.attachEvent(`load`,this._connect.bind(this));return}var t=Math.max(this._timeout,this._rto*e.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),t),b(`using timeout`,t);var n=c.addPath(this._transUrl,`/`+this._server+`/`+this._generateSessionId()),i=this._transportOptions[e.transportName];b(`transport url`,n);var a=new e(n,this._transUrl,i);a.on(`message`,this._transportMessage.bind(this)),a.once(`close`,this._transportClose.bind(this)),a.transportName=e.transportName,this._transport=a;return}this._close(2e3,`All transports failed`,!1)},S.prototype._transportTimeout=function(){b(`_transportTimeout`),this.readyState===S.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,`Transport timed out`))},S.prototype._transportMessage=function(e){b(`_transportMessage`,e);var t=this,n=e.slice(0,1),r=e.slice(1),i;switch(n){case`o`:this._open();return;case`h`:this.dispatchEvent(new m(`heartbeat`)),b(`heartbeat`,this.transport);return}if(r)try{i=JSON.parse(r)}catch{b(`bad json`,r)}if(i===void 0){b(`empty payload`,r);return}switch(n){case`a`:Array.isArray(i)&&i.forEach(function(e){b(`message`,t.transport,e),t.dispatchEvent(new v(e))});break;case`m`:b(`message`,this.transport,i),this.dispatchEvent(new v(i));break;case`c`:Array.isArray(i)&&i.length===2&&this._close(i[0],i[1],!0);break}},S.prototype._transportClose=function(e,t){if(b(`_transportClose`,this.transport,e,t),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!C(e)&&e!==2e3&&this.readyState===S.CONNECTING){this._connect();return}this._close(e,t)},S.prototype._open=function(){b(`_open`,this._transport&&this._transport.transportName,this.readyState),this.readyState===S.CONNECTING?(this._transportTimeoutId&&=(clearTimeout(this._transportTimeoutId),null),this.readyState=S.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new m(`open`)),b(`connected`,this.transport)):this._close(1006,`Server lost session`)},S.prototype._close=function(e,t,n){b(`_close`,this.transport,e,t,n,this.readyState);var r=!1;if(this._ir&&=(r=!0,this._ir.close(),null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===S.CLOSED)throw Error(`InvalidStateError: SockJS has already been closed`);this.readyState=S.CLOSING,setTimeout(function(){this.readyState=S.CLOSED,r&&this.dispatchEvent(new m(`error`));var i=new _(`close`);i.wasClean=n||!1,i.code=e||1e3,i.reason=t,this.dispatchEvent(i),this.onmessage=this.onclose=this.onerror=null,b(`disconnected`)}.bind(this),0)},S.prototype.countRTO=function(e){return e>100?4*e:300+e},t.exports=function(t){return x=u(t),e(`./iframe-bootstrap`)(S,t),S}}).call(this)}).call(this,{env:{}},typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"./event/close":2,"./event/event":4,"./event/eventtarget":5,"./event/trans-message":6,"./iframe-bootstrap":8,"./info-receiver":12,"./location":13,"./shims":15,"./utils/browser":44,"./utils/escape":45,"./utils/event":46,"./utils/log":48,"./utils/object":49,"./utils/random":50,"./utils/transport":51,"./utils/url":52,"./version":53,debug:55,inherits:57,"url-parse":60}],15:[function(e,t,n){var r=Array.prototype,i=Object.prototype,a=Function.prototype,o=String.prototype,s=r.slice,c=i.toString,l=function(e){return i.toString.call(e)===`[object Function]`},u=function(e){return c.call(e)===`[object Array]`},d=function(e){return c.call(e)===`[object String]`},f=Object.defineProperty&&function(){try{return Object.defineProperty({},`x`,{}),!0}catch{return!1}}()?function(e,t,n,r){!r&&t in e||Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(e,t,n,r){!r&&t in e||(e[t]=n)},p=function(e,t,n){for(var r in t)i.hasOwnProperty.call(t,r)&&f(e,r,t[r],n)},m=function(e){if(e==null)throw TypeError(`can't convert `+e+` to object`);return Object(e)};function h(e){var t=+e;return t===t?t!==0&&t!==1/0&&t!==-1/0&&(t=(t>0||-1)*Math.floor(Math.abs(t))):t=0,t}function g(e){return e>>>0}function _(){}p(a,{bind:function(e){var t=this;if(!l(t))throw TypeError(`Function.prototype.bind called on incompatible `+t);for(var n=s.call(arguments,1),r=function(){if(this instanceof c){var r=t.apply(this,n.concat(s.call(arguments)));return Object(r)===r?r:this}else return t.apply(e,n.concat(s.call(arguments)))},i=Math.max(0,t.length-n.length),a=[],o=0;o<i;o++)a.push(`$`+o);var c=Function(`binder`,`return function (`+a.join(`,`)+`){ return binder.apply(this, arguments); }`)(r);return t.prototype&&(_.prototype=t.prototype,c.prototype=new _,_.prototype=null),c}}),p(Array,{isArray:u});var v=Object(`a`),y=v[0]!==`a`||!(0 in v);p(r,{forEach:function(e){var t=m(this),n=y&&d(this)?this.split(``):t,r=arguments[1],i=-1,a=n.length>>>0;if(!l(e))throw TypeError();for(;++i<a;)i in n&&e.call(r,n[i],i,t)}},!function(e){var t=!0,n=!0;return e&&(e.call(`foo`,function(e,n,r){typeof r!=`object`&&(t=!1)}),e.call([1],function(){n=typeof this==`string`},`x`)),!!e&&t&&n}(r.forEach)),p(r,{indexOf:function(e){var t=y&&d(this)?this.split(``):m(this),n=t.length>>>0;if(!n)return-1;var r=0;for(arguments.length>1&&(r=h(arguments[1])),r=r>=0?r:Math.max(0,n+r);r<n;r++)if(r in t&&t[r]===e)return r;return-1}},Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1);var b=o.split;`ab`.split(/(?:ab)*/).length!==2||`.`.split(/(.?)(.?)/).length!==4||`tesst`.split(/(s)*/)[1]===`t`||`test`.split(/(?:)/,-1).length!==4||``.split(/.?/).length||`.`.split(/()()/).length>1?(function(){var e=/()??/.exec(``)[1]===void 0;o.split=function(t,n){var i=this;if(t===void 0&&n===0)return[];if(c.call(t)!==`[object RegExp]`)return b.call(this,t,n);var a=[],o=(t.ignoreCase?`i`:``)+(t.multiline?`m`:``)+(t.extended?`x`:``)+(t.sticky?`y`:``),s=0,l,u,d,f;for(t=new RegExp(t.source,o+`g`),i+=``,e||(l=RegExp(`^`+t.source+`$(?!\\s)`,o)),n=n===void 0?-1>>>0:g(n);(u=t.exec(i))&&(d=u.index+u[0].length,!(d>s&&(a.push(i.slice(s,u.index)),!e&&u.length>1&&u[0].replace(l,function(){for(var e=1;e<arguments.length-2;e++)arguments[e]===void 0&&(u[e]=void 0)}),u.length>1&&u.index<i.length&&r.push.apply(a,u.slice(1)),f=u[0].length,s=d,a.length>=n)));)t.lastIndex===u.index&&t.lastIndex++;return s===i.length?(f||!t.test(``))&&a.push(``):a.push(i.slice(s)),a.length>n?a.slice(0,n):a}})():`0`.split(void 0,0).length&&(o.split=function(e,t){return e===void 0&&t===0?[]:b.call(this,e,t)});var x=o.substr;p(o,{substr:function(e,t){return x.call(this,e<0&&(e=this.length+e)<0?0:e,t)}},``.substr&&`0b`.substr(-1)!==`b`)},{}],16:[function(e,t,n){t.exports=[e(`./transport/websocket`),e(`./transport/xhr-streaming`),e(`./transport/xdr-streaming`),e(`./transport/eventsource`),e(`./transport/lib/iframe-wrap`)(e(`./transport/eventsource`)),e(`./transport/htmlfile`),e(`./transport/lib/iframe-wrap`)(e(`./transport/htmlfile`)),e(`./transport/xhr-polling`),e(`./transport/xdr-polling`),e(`./transport/lib/iframe-wrap`)(e(`./transport/xhr-polling`)),e(`./transport/jsonp-polling`)]},{"./transport/eventsource":20,"./transport/htmlfile":21,"./transport/jsonp-polling":23,"./transport/lib/iframe-wrap":26,"./transport/websocket":38,"./transport/xdr-polling":39,"./transport/xdr-streaming":40,"./transport/xhr-polling":41,"./transport/xhr-streaming":42}],17:[function(e,t,n){(function(n,r){(function(){var i=e(`events`).EventEmitter,a=e(`inherits`),o=e(`../../utils/event`),s=e(`../../utils/url`),c=r.XMLHttpRequest,l=function(){};n.env.NODE_ENV!==`production`&&(l=e(`debug`)(`sockjs-client:browser:xhr`));function u(e,t,n,r){l(e,t);var a=this;i.call(this),setTimeout(function(){a._start(e,t,n,r)},0)}a(u,i),u.prototype._start=function(e,t,n,r){var i=this;try{this.xhr=new c}catch{}if(!this.xhr){l(`no xhr`),this.emit(`finish`,0,`no xhr support`),this._cleanup();return}t=s.addQuery(t,`t=`+ +new Date),this.unloadRef=o.unloadAdd(function(){l(`unload cleanup`),i._cleanup(!0)});try{this.xhr.open(e,t,!0),this.timeout&&`timeout`in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){l(`xhr timeout`),i.emit(`finish`,0,``),i._cleanup(!1)})}catch(e){l(`exception`,e),this.emit(`finish`,0,``),this._cleanup(!1);return}if((!r||!r.noCredentials)&&u.supportsCORS&&(l(`withCredentials`),this.xhr.withCredentials=!0),r&&r.headers)for(var a in r.headers)this.xhr.setRequestHeader(a,r.headers[a]);this.xhr.onreadystatechange=function(){if(i.xhr){var e=i.xhr,t,n;switch(l(`readyState`,e.readyState),e.readyState){case 3:try{n=e.status,t=e.responseText}catch{}l(`status`,n),n===1223&&(n=204),n===200&&t&&t.length>0&&(l(`chunk`),i.emit(`chunk`,n,t));break;case 4:n=e.status,l(`status`,n),n===1223&&(n=204),(n===12005||n===12029)&&(n=0),l(`finish`,n,e.responseText),i.emit(`finish`,n,e.responseText),i._cleanup(!1);break}}};try{i.xhr.send(n)}catch{i.emit(`finish`,0,``),i._cleanup(!1)}},u.prototype._cleanup=function(e){if(l(`cleanup`),this.xhr){if(this.removeAllListeners(),o.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),e)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}},u.prototype.close=function(){l(`close`),this._cleanup(!0)},u.enabled=!!c;var d=[`Active`,`Object`].join(`X`);!u.enabled&&d in r&&(l(`overriding xmlhttprequest`),c=function(){try{return new r[d](`Microsoft.XMLHTTP`)}catch{return null}},u.enabled=!!new c);var f=!1;try{f=`withCredentials`in new c}catch{}u.supportsCORS=f,t.exports=u}).call(this)}).call(this,{env:{}},typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"../../utils/event":46,"../../utils/url":52,debug:55,events:3,inherits:57}],18:[function(e,t,n){(function(e){(function(){t.exports=e.EventSource}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{}],19:[function(e,t,n){(function(e){(function(){var n=e.WebSocket||e.MozWebSocket;n?t.exports=function(e){return new n(e)}:t.exports=void 0}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{}],20:[function(e,t,n){var r=e(`inherits`),i=e(`./lib/ajax-based`),a=e(`./receiver/eventsource`),o=e(`./sender/xhr-cors`),s=e(`eventsource`);function c(e){if(!c.enabled())throw Error(`Transport created when disabled`);i.call(this,e,`/eventsource`,a,o)}r(c,i),c.enabled=function(){return!!s},c.transportName=`eventsource`,c.roundTrips=2,t.exports=c},{"./lib/ajax-based":24,"./receiver/eventsource":29,"./sender/xhr-cors":35,eventsource:18,inherits:57}],21:[function(e,t,n){var r=e(`inherits`),i=e(`./receiver/htmlfile`),a=e(`./sender/xhr-local`),o=e(`./lib/ajax-based`);function s(e){if(!i.enabled)throw Error(`Transport created when disabled`);o.call(this,e,`/htmlfile`,i,a)}r(s,o),s.enabled=function(e){return i.enabled&&e.sameOrigin},s.transportName=`htmlfile`,s.roundTrips=2,t.exports=s},{"./lib/ajax-based":24,"./receiver/htmlfile":30,"./sender/xhr-local":37,inherits:57}],22:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`events`).EventEmitter,a=e(`../version`),o=e(`../utils/url`),s=e(`../utils/iframe`),c=e(`../utils/event`),l=e(`../utils/random`),u=function(){};n.env.NODE_ENV!==`production`&&(u=e(`debug`)(`sockjs-client:transport:iframe`));function d(e,t,n){if(!d.enabled())throw Error(`Transport created when disabled`);i.call(this);var r=this;this.origin=o.getOrigin(n),this.baseUrl=n,this.transUrl=t,this.transport=e,this.windowId=l.string(8);var a=o.addPath(n,`/iframe.html`)+`#`+this.windowId;u(e,t,a),this.iframeObj=s.createIframe(a,function(e){u(`err callback`),r.emit(`close`,1006,`Unable to load an iframe (`+e+`)`),r.close()}),this.onmessageCallback=this._message.bind(this),c.attachEvent(`message`,this.onmessageCallback)}r(d,i),d.prototype.close=function(){if(u(`close`),this.removeAllListeners(),this.iframeObj){c.detachEvent(`message`,this.onmessageCallback);try{this.postMessage(`c`)}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},d.prototype._message=function(e){if(u(`message`,e.data),!o.isOriginEqual(e.origin,this.origin)){u(`not same origin`,e.origin,this.origin);return}var t;try{t=JSON.parse(e.data)}catch{u(`bad json`,e.data);return}if(t.windowId!==this.windowId){u(`mismatched window id`,t.windowId,this.windowId);return}switch(t.type){case`s`:this.iframeObj.loaded(),this.postMessage(`s`,JSON.stringify([a,this.transport,this.transUrl,this.baseUrl]));break;case`t`:this.emit(`message`,t.data);break;case`c`:var n;try{n=JSON.parse(t.data)}catch{u(`bad json`,t.data);return}this.emit(`close`,n[0],n[1]),this.close();break}},d.prototype.postMessage=function(e,t){u(`postMessage`,e,t),this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:e,data:t||``}),this.origin)},d.prototype.send=function(e){u(`send`,e),this.postMessage(`m`,e)},d.enabled=function(){return s.iframeEnabled},d.transportName=`iframe`,d.roundTrips=2,t.exports=d}).call(this)}).call(this,{env:{}})},{"../utils/event":46,"../utils/iframe":47,"../utils/random":50,"../utils/url":52,"../version":53,debug:55,events:3,inherits:57}],23:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`./lib/sender-receiver`),a=e(`./receiver/jsonp`),o=e(`./sender/jsonp`);function s(e){if(!s.enabled())throw Error(`Transport created when disabled`);i.call(this,e,`/jsonp`,o,a)}r(s,i),s.enabled=function(){return!!n.document},s.transportName=`jsonp-polling`,s.roundTrips=1,s.needBody=!0,t.exports=s}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"./lib/sender-receiver":28,"./receiver/jsonp":31,"./sender/jsonp":33,inherits:57}],24:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`../../utils/url`),a=e(`./sender-receiver`),o=function(){};n.env.NODE_ENV!==`production`&&(o=e(`debug`)(`sockjs-client:ajax-based`));function s(e){return function(t,n,r){o(`create ajax sender`,t,n);var a={};typeof n==`string`&&(a.headers={"Content-type":`text/plain`});var s=new e(`POST`,i.addPath(t,`/xhr_send`),n,a);return s.once(`finish`,function(e){if(o(`finish`,e),s=null,e!==200&&e!==204)return r(Error(`http status `+e));r()}),function(){o(`abort`),s.close(),s=null;var e=Error(`Aborted`);e.code=1e3,r(e)}}}function c(e,t,n,r){a.call(this,e,t,s(r),n,r)}r(c,a),t.exports=c}).call(this)}).call(this,{env:{}})},{"../../utils/url":52,"./sender-receiver":28,debug:55,inherits:57}],25:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`events`).EventEmitter,a=function(){};n.env.NODE_ENV!==`production`&&(a=e(`debug`)(`sockjs-client:buffered-sender`));function o(e,t){a(e),i.call(this),this.sendBuffer=[],this.sender=t,this.url=e}r(o,i),o.prototype.send=function(e){a(`send`,e),this.sendBuffer.push(e),this.sendStop||this.sendSchedule()},o.prototype.sendScheduleWait=function(){a(`sendScheduleWait`);var e=this,t;this.sendStop=function(){a(`sendStop`),e.sendStop=null,clearTimeout(t)},t=setTimeout(function(){a(`timeout`),e.sendStop=null,e.sendSchedule()},25)},o.prototype.sendSchedule=function(){a(`sendSchedule`,this.sendBuffer.length);var e=this;if(this.sendBuffer.length>0){var t=`[`+this.sendBuffer.join(`,`)+`]`;this.sendStop=this.sender(this.url,t,function(t){e.sendStop=null,t?(a(`error`,t),e.emit(`close`,t.code||1006,`Sending error: `+t),e.close()):e.sendScheduleWait()}),this.sendBuffer=[]}},o.prototype._cleanup=function(){a(`_cleanup`),this.removeAllListeners()},o.prototype.close=function(){a(`close`),this._cleanup(),this.sendStop&&=(this.sendStop(),null)},t.exports=o}).call(this)}).call(this,{env:{}})},{debug:55,events:3,inherits:57}],26:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`../iframe`),a=e(`../../utils/object`);t.exports=function(e){function t(t,n){i.call(this,e.transportName,t,n)}return r(t,i),t.enabled=function(t,r){if(!n.document)return!1;var o=a.extend({},r);return o.sameOrigin=!0,e.enabled(o)&&i.enabled()},t.transportName=`iframe-`+e.transportName,t.needBody=!0,t.roundTrips=i.roundTrips+e.roundTrips-1,t.facadeTransport=e,t}}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"../../utils/object":49,"../iframe":22,inherits:57}],27:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`events`).EventEmitter,a=function(){};n.env.NODE_ENV!==`production`&&(a=e(`debug`)(`sockjs-client:polling`));function o(e,t,n){a(t),i.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=n,this._scheduleReceiver()}r(o,i),o.prototype._scheduleReceiver=function(){a(`_scheduleReceiver`);var e=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on(`message`,function(t){a(`message`,t),e.emit(`message`,t)}),t.once(`close`,function(n,r){a(`close`,n,r,e.pollIsClosing),e.poll=t=null,e.pollIsClosing||(r===`network`?e._scheduleReceiver():(e.emit(`close`,n||1006,r),e.removeAllListeners()))})},o.prototype.abort=function(){a(`abort`),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},t.exports=o}).call(this)}).call(this,{env:{}})},{debug:55,events:3,inherits:57}],28:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`../../utils/url`),a=e(`./buffered-sender`),o=e(`./polling`),s=function(){};n.env.NODE_ENV!==`production`&&(s=e(`debug`)(`sockjs-client:sender-receiver`));function c(e,t,n,r,c){var l=i.addPath(e,t);s(l);var u=this;a.call(this,e,n),this.poll=new o(r,l,c),this.poll.on(`message`,function(e){s(`poll message`,e),u.emit(`message`,e)}),this.poll.once(`close`,function(e,t){s(`poll close`,e,t),u.poll=null,u.emit(`close`,e,t),u.close()})}r(c,a),c.prototype.close=function(){a.prototype.close.call(this),s(`close`),this.removeAllListeners(),this.poll&&=(this.poll.abort(),null)},t.exports=c}).call(this)}).call(this,{env:{}})},{"../../utils/url":52,"./buffered-sender":25,"./polling":27,debug:55,inherits:57}],29:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`events`).EventEmitter,a=e(`eventsource`),o=function(){};n.env.NODE_ENV!==`production`&&(o=e(`debug`)(`sockjs-client:receiver:eventsource`));function s(e){o(e),i.call(this);var t=this,n=this.es=new a(e);n.onmessage=function(e){o(`message`,e.data),t.emit(`message`,decodeURI(e.data))},n.onerror=function(e){o(`error`,n.readyState,e);var r=n.readyState===2?`permanent`:`network`;t._cleanup(),t._close(r)}}r(s,i),s.prototype.abort=function(){o(`abort`),this._cleanup(),this._close(`user`)},s.prototype._cleanup=function(){o(`cleanup`);var e=this.es;e&&(e.onmessage=e.onerror=null,e.close(),this.es=null)},s.prototype._close=function(e){o(`close`,e);var t=this;setTimeout(function(){t.emit(`close`,null,e),t.removeAllListeners()},200)},t.exports=s}).call(this)}).call(this,{env:{}})},{debug:55,events:3,eventsource:18,inherits:57}],30:[function(e,t,n){(function(n,r){(function(){var i=e(`inherits`),a=e(`../../utils/iframe`),o=e(`../../utils/url`),s=e(`events`).EventEmitter,c=e(`../../utils/random`),l=function(){};n.env.NODE_ENV!==`production`&&(l=e(`debug`)(`sockjs-client:receiver:htmlfile`));function u(e){l(e),s.call(this);var t=this;a.polluteGlobalNamespace(),this.id=`a`+c.string(6),e=o.addQuery(e,`c=`+decodeURIComponent(a.WPrefix+`.`+this.id)),l(`using htmlfile`,u.htmlfileEnabled);var n=u.htmlfileEnabled?a.createHtmlfile:a.createIframe;r[a.WPrefix][this.id]={start:function(){l(`start`),t.iframeObj.loaded()},message:function(e){l(`message`,e),t.emit(`message`,e)},stop:function(){l(`stop`),t._cleanup(),t._close(`network`)}},this.iframeObj=n(e,function(){l(`callback`),t._cleanup(),t._close(`permanent`)})}i(u,s),u.prototype.abort=function(){l(`abort`),this._cleanup(),this._close(`user`)},u.prototype._cleanup=function(){l(`_cleanup`),this.iframeObj&&=(this.iframeObj.cleanup(),null),delete r[a.WPrefix][this.id]},u.prototype._close=function(e){l(`_close`,e),this.emit(`close`,null,e),this.removeAllListeners()},u.htmlfileEnabled=!1;var d=[`Active`,`Object`].join(`X`);if(d in r)try{u.htmlfileEnabled=!!new r[d](`htmlfile`)}catch{}u.enabled=u.htmlfileEnabled||a.iframeEnabled,t.exports=u}).call(this)}).call(this,{env:{}},typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:55,events:3,inherits:57}],31:[function(e,t,n){(function(n,r){(function(){var i=e(`../../utils/iframe`),a=e(`../../utils/random`),o=e(`../../utils/browser`),s=e(`../../utils/url`),c=e(`inherits`),l=e(`events`).EventEmitter,u=function(){};n.env.NODE_ENV!==`production`&&(u=e(`debug`)(`sockjs-client:receiver:jsonp`));function d(e){u(e);var t=this;l.call(this),i.polluteGlobalNamespace(),this.id=`a`+a.string(6);var n=s.addQuery(e,`c=`+encodeURIComponent(i.WPrefix+`.`+this.id));r[i.WPrefix][this.id]=this._callback.bind(this),this._createScript(n),this.timeoutId=setTimeout(function(){u(`timeout`),t._abort(Error(`JSONP script loaded abnormally (timeout)`))},d.timeout)}c(d,l),d.prototype.abort=function(){if(u(`abort`),r[i.WPrefix][this.id]){var e=Error(`JSONP user aborted read`);e.code=1e3,this._abort(e)}},d.timeout=35e3,d.scriptErrorTimeout=1e3,d.prototype._callback=function(e){u(`_callback`,e),this._cleanup(),!this.aborting&&(e&&(u(`message`,e),this.emit(`message`,e)),this.emit(`close`,null,`network`),this.removeAllListeners())},d.prototype._abort=function(e){u(`_abort`,e),this._cleanup(),this.aborting=!0,this.emit(`close`,e.code,e.message),this.removeAllListeners()},d.prototype._cleanup=function(){if(u(`_cleanup`),clearTimeout(this.timeoutId),this.script2&&=(this.script2.parentNode.removeChild(this.script2),null),this.script){var e=this.script;e.parentNode.removeChild(e),e.onreadystatechange=e.onerror=e.onload=e.onclick=null,this.script=null}delete r[i.WPrefix][this.id]},d.prototype._scriptError=function(){u(`_scriptError`);var e=this;this.errorTimer||=setTimeout(function(){e.loadedOkay||e._abort(Error(`JSONP script loaded abnormally (onerror)`))},d.scriptErrorTimeout)},d.prototype._createScript=function(e){u(`_createScript`,e);var t=this,n=this.script=r.document.createElement(`script`),i;if(n.id=`a`+a.string(8),n.src=e,n.type=`text/javascript`,n.charset=`UTF-8`,n.onerror=this._scriptError.bind(this),n.onload=function(){u(`onload`),t._abort(Error(`JSONP script loaded abnormally (onload)`))},n.onreadystatechange=function(){if(u(`onreadystatechange`,n.readyState),/loaded|closed/.test(n.readyState)){if(n&&n.htmlFor&&n.onclick){t.loadedOkay=!0;try{n.onclick()}catch{}}n&&t._abort(Error(`JSONP script loaded abnormally (onreadystatechange)`))}},n.async===void 0&&r.document.attachEvent)if(o.isOpera())i=this.script2=r.document.createElement(`script`),i.text=`try{var a = document.getElementById('`+n.id+`'); if(a)a.onerror();}catch(x){};`,n.async=i.async=!1;else{try{n.htmlFor=n.id,n.event=`onclick`}catch{}n.async=!0}n.async!==void 0&&(n.async=!0);var s=r.document.getElementsByTagName(`head`)[0];s.insertBefore(n,s.firstChild),i&&s.insertBefore(i,s.firstChild)},t.exports=d}).call(this)}).call(this,{env:{}},typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"../../utils/browser":44,"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:55,events:3,inherits:57}],32:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`events`).EventEmitter,a=function(){};n.env.NODE_ENV!==`production`&&(a=e(`debug`)(`sockjs-client:receiver:xhr`));function o(e,t){a(e),i.call(this);var n=this;this.bufferPosition=0,this.xo=new t(`POST`,e,null),this.xo.on(`chunk`,this._chunkHandler.bind(this)),this.xo.once(`finish`,function(e,t){a(`finish`,e,t),n._chunkHandler(e,t),n.xo=null;var r=e===200?`network`:`permanent`;a(`close`,r),n.emit(`close`,null,r),n._cleanup()})}r(o,i),o.prototype._chunkHandler=function(e,t){if(a(`_chunkHandler`,e),!(e!==200||!t))for(var n=-1;;this.bufferPosition+=n+1){var r=t.slice(this.bufferPosition);if(n=r.indexOf(`
`),n===-1)break;var i=r.slice(0,n);i&&(a(`message`,i),this.emit(`message`,i))}},o.prototype._cleanup=function(){a(`_cleanup`),this.removeAllListeners()},o.prototype.abort=function(){a(`abort`),this.xo&&=(this.xo.close(),a(`close`),this.emit(`close`,null,`user`),null),this._cleanup()},t.exports=o}).call(this)}).call(this,{env:{}})},{debug:55,events:3,inherits:57}],33:[function(e,t,n){(function(n,r){(function(){var i=e(`../../utils/random`),a=e(`../../utils/url`),o=function(){};n.env.NODE_ENV!==`production`&&(o=e(`debug`)(`sockjs-client:sender:jsonp`));var s,c;function l(e){o(`createIframe`,e);try{return r.document.createElement(`<iframe name="`+e+`">`)}catch{var t=r.document.createElement(`iframe`);return t.name=e,t}}function u(){o(`createForm`),s=r.document.createElement(`form`),s.style.display=`none`,s.style.position=`absolute`,s.method=`POST`,s.enctype=`application/x-www-form-urlencoded`,s.acceptCharset=`UTF-8`,c=r.document.createElement(`textarea`),c.name=`d`,s.appendChild(c),r.document.body.appendChild(s)}t.exports=function(e,t,n){o(e,t),s||u();var r=`a`+i.string(8);s.target=r,s.action=a.addQuery(a.addPath(e,`/jsonp_send`),`i=`+r);var d=l(r);d.id=r,d.style.display=`none`,s.appendChild(d);try{c.value=t}catch{}s.submit();var f=function(e){o(`completed`,r,e),d.onerror&&(d.onreadystatechange=d.onerror=d.onload=null,setTimeout(function(){o(`cleaning up`,r),d.parentNode.removeChild(d),d=null},500),c.value=``,n(e))};return d.onerror=function(){o(`onerror`,r),f()},d.onload=function(){o(`onload`,r),f()},d.onreadystatechange=function(e){o(`onreadystatechange`,r,d.readyState,e),d.readyState===`complete`&&f()},function(){o(`aborted`,r),f(Error(`Aborted`))}}}).call(this)}).call(this,{env:{}},typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"../../utils/random":50,"../../utils/url":52,debug:55}],34:[function(e,t,n){(function(n,r){(function(){var i=e(`events`).EventEmitter,a=e(`inherits`),o=e(`../../utils/event`),s=e(`../../utils/browser`),c=e(`../../utils/url`),l=function(){};n.env.NODE_ENV!==`production`&&(l=e(`debug`)(`sockjs-client:sender:xdr`));function u(e,t,n){l(e,t);var r=this;i.call(this),setTimeout(function(){r._start(e,t,n)},0)}a(u,i),u.prototype._start=function(e,t,n){l(`_start`);var i=this,a=new r.XDomainRequest;t=c.addQuery(t,`t=`+ +new Date),a.onerror=function(){l(`onerror`),i._error()},a.ontimeout=function(){l(`ontimeout`),i._error()},a.onprogress=function(){l(`progress`,a.responseText),i.emit(`chunk`,200,a.responseText)},a.onload=function(){l(`load`),i.emit(`finish`,200,a.responseText),i._cleanup(!1)},this.xdr=a,this.unloadRef=o.unloadAdd(function(){i._cleanup(!0)});try{this.xdr.open(e,t),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(n)}catch{this._error()}},u.prototype._error=function(){this.emit(`finish`,0,``),this._cleanup(!1)},u.prototype._cleanup=function(e){if(l(`cleanup`,e),this.xdr){if(this.removeAllListeners(),o.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,e)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}},u.prototype.close=function(){l(`close`),this._cleanup(!0)},u.enabled=!!(r.XDomainRequest&&s.hasDomain()),t.exports=u}).call(this)}).call(this,{env:{}},typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"../../utils/browser":44,"../../utils/event":46,"../../utils/url":52,debug:55,events:3,inherits:57}],35:[function(e,t,n){var r=e(`inherits`),i=e(`../driver/xhr`);function a(e,t,n,r){i.call(this,e,t,n,r)}r(a,i),a.enabled=i.enabled&&i.supportsCORS,t.exports=a},{"../driver/xhr":17,inherits:57}],36:[function(e,t,n){var r=e(`events`).EventEmitter,i=e(`inherits`);function a(){var e=this;r.call(this),this.to=setTimeout(function(){e.emit(`finish`,200,`{}`)},a.timeout)}i(a,r),a.prototype.close=function(){clearTimeout(this.to)},a.timeout=2e3,t.exports=a},{events:3,inherits:57}],37:[function(e,t,n){var r=e(`inherits`),i=e(`../driver/xhr`);function a(e,t,n){i.call(this,e,t,n,{noCredentials:!0})}r(a,i),a.enabled=i.enabled,t.exports=a},{"../driver/xhr":17,inherits:57}],38:[function(e,t,n){(function(n){(function(){var r=e(`../utils/event`),i=e(`../utils/url`),a=e(`inherits`),o=e(`events`).EventEmitter,s=e(`./driver/websocket`),c=function(){};n.env.NODE_ENV!==`production`&&(c=e(`debug`)(`sockjs-client:websocket`));function l(e,t,n){if(!l.enabled())throw Error(`Transport created when disabled`);o.call(this),c(`constructor`,e);var a=this,u=i.addPath(e,`/websocket`);u=u.slice(0,5)===`https`?`wss`+u.slice(5):`ws`+u.slice(4),this.url=u,this.ws=new s(this.url,[],n),this.ws.onmessage=function(e){c(`message event`,e.data),a.emit(`message`,e.data)},this.unloadRef=r.unloadAdd(function(){c(`unload`),a.ws.close()}),this.ws.onclose=function(e){c(`close event`,e.code,e.reason),a.emit(`close`,e.code,e.reason),a._cleanup()},this.ws.onerror=function(e){c(`error event`,e),a.emit(`close`,1006,`WebSocket connection broken`),a._cleanup()}}a(l,o),l.prototype.send=function(e){var t=`[`+e+`]`;c(`send`,t),this.ws.send(t)},l.prototype.close=function(){c(`close`);var e=this.ws;this._cleanup(),e&&e.close()},l.prototype._cleanup=function(){c(`_cleanup`);var e=this.ws;e&&(e.onmessage=e.onclose=e.onerror=null),r.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},l.enabled=function(){return c(`enabled`),!!s},l.transportName=`websocket`,l.roundTrips=2,t.exports=l}).call(this)}).call(this,{env:{}})},{"../utils/event":46,"../utils/url":52,"./driver/websocket":19,debug:55,events:3,inherits:57}],39:[function(e,t,n){var r=e(`inherits`),i=e(`./lib/ajax-based`),a=e(`./xdr-streaming`),o=e(`./receiver/xhr`),s=e(`./sender/xdr`);function c(e){if(!s.enabled)throw Error(`Transport created when disabled`);i.call(this,e,`/xhr`,o,s)}r(c,i),c.enabled=a.enabled,c.transportName=`xdr-polling`,c.roundTrips=2,t.exports=c},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,"./xdr-streaming":40,inherits:57}],40:[function(e,t,n){var r=e(`inherits`),i=e(`./lib/ajax-based`),a=e(`./receiver/xhr`),o=e(`./sender/xdr`);function s(e){if(!o.enabled)throw Error(`Transport created when disabled`);i.call(this,e,`/xhr_streaming`,a,o)}r(s,i),s.enabled=function(e){return e.cookie_needed||e.nullOrigin?!1:o.enabled&&e.sameScheme},s.transportName=`xdr-streaming`,s.roundTrips=2,t.exports=s},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,inherits:57}],41:[function(e,t,n){var r=e(`inherits`),i=e(`./lib/ajax-based`),a=e(`./receiver/xhr`),o=e(`./sender/xhr-cors`),s=e(`./sender/xhr-local`);function c(e){if(!s.enabled&&!o.enabled)throw Error(`Transport created when disabled`);i.call(this,e,`/xhr`,a,o)}r(c,i),c.enabled=function(e){return e.nullOrigin?!1:s.enabled&&e.sameOrigin?!0:o.enabled},c.transportName=`xhr-polling`,c.roundTrips=2,t.exports=c},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:57}],42:[function(e,t,n){(function(n){(function(){var r=e(`inherits`),i=e(`./lib/ajax-based`),a=e(`./receiver/xhr`),o=e(`./sender/xhr-cors`),s=e(`./sender/xhr-local`),c=e(`../utils/browser`);function l(e){if(!s.enabled&&!o.enabled)throw Error(`Transport created when disabled`);i.call(this,e,`/xhr_streaming`,a,o)}r(l,i),l.enabled=function(e){return e.nullOrigin||c.isOpera()?!1:o.enabled},l.transportName=`xhr-streaming`,l.roundTrips=2,l.needBody=!!n.document,t.exports=l}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"../utils/browser":44,"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:57}],43:[function(e,t,n){(function(e){(function(){e.crypto&&e.crypto.getRandomValues?t.exports.randomBytes=function(t){var n=new Uint8Array(t);return e.crypto.getRandomValues(n),n}:t.exports.randomBytes=function(e){for(var t=Array(e),n=0;n<e;n++)t[n]=Math.floor(Math.random()*256);return t}}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{}],44:[function(e,t,n){(function(e){(function(){t.exports={isOpera:function(){return e.navigator&&/opera/i.test(e.navigator.userAgent)},isKonqueror:function(){return e.navigator&&/konqueror/i.test(e.navigator.userAgent)},hasDomain:function(){if(!e.document)return!0;try{return!!e.document.domain}catch{return!1}}}}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{}],45:[function(e,t,n){var r=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,i,a=function(e){var t,n={},r=[];for(t=0;t<65536;t++)r.push(String.fromCharCode(t));return e.lastIndex=0,r.join(``).replace(e,function(e){return n[e]=`\\u`+(`0000`+e.charCodeAt(0).toString(16)).slice(-4),``}),e.lastIndex=0,n};t.exports={quote:function(e){var t=JSON.stringify(e);return r.lastIndex=0,r.test(t)?(i||=a(r),t.replace(r,function(e){return i[e]})):t}}},{}],46:[function(e,t,n){(function(n){(function(){var r=e(`./random`),i={},a=!1,o=n.chrome&&n.chrome.app&&n.chrome.app.runtime;t.exports={attachEvent:function(e,t){n.addEventListener===void 0?n.document&&n.attachEvent&&(n.document.attachEvent(`on`+e,t),n.attachEvent(`on`+e,t)):n.addEventListener(e,t,!1)},detachEvent:function(e,t){n.addEventListener===void 0?n.document&&n.detachEvent&&(n.document.detachEvent(`on`+e,t),n.detachEvent(`on`+e,t)):n.removeEventListener(e,t,!1)},unloadAdd:function(e){if(o)return null;var t=r.string(8);return i[t]=e,a&&setTimeout(this.triggerUnloadCallbacks,0),t},unloadDel:function(e){e in i&&delete i[e]},triggerUnloadCallbacks:function(){for(var e in i)i[e](),delete i[e]}},o||t.exports.attachEvent(`unload`,function(){a||(a=!0,t.exports.triggerUnloadCallbacks())})}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"./random":50}],47:[function(e,t,n){(function(n,r){(function(){var i=e(`./event`),a=e(`./browser`),o=function(){};n.env.NODE_ENV!==`production`&&(o=e(`debug`)(`sockjs-client:utils:iframe`)),t.exports={WPrefix:`_jp`,currentWindowId:null,polluteGlobalNamespace:function(){t.exports.WPrefix in r||(r[t.exports.WPrefix]={})},postMessage:function(e,n){r.parent===r?o(`Cannot postMessage, no parent window.`,e,n):r.parent.postMessage(JSON.stringify({windowId:t.exports.currentWindowId,type:e,data:n||``}),`*`)},createIframe:function(e,t){var n=r.document.createElement(`iframe`),a,s,c=function(){o(`unattach`),clearTimeout(a);try{n.onload=null}catch{}n.onerror=null},l=function(){o(`cleanup`),n&&(c(),setTimeout(function(){n&&n.parentNode.removeChild(n),n=null},0),i.unloadDel(s))},u=function(e){o(`onerror`,e),n&&(l(),t(e))},d=function(e,t){o(`post`,e,t),setTimeout(function(){try{n&&n.contentWindow&&n.contentWindow.postMessage(e,t)}catch{}},0)};return n.src=e,n.style.display=`none`,n.style.position=`absolute`,n.onerror=function(){u(`onerror`)},n.onload=function(){o(`onload`),clearTimeout(a),a=setTimeout(function(){u(`onload timeout`)},2e3)},r.document.body.appendChild(n),a=setTimeout(function(){u(`timeout`)},15e3),s=i.unloadAdd(l),{post:d,cleanup:l,loaded:c}},createHtmlfile:function(e,n){var a=new r[[`Active`,`Object`].join(`X`)](`htmlfile`),s,c,l,u=function(){clearTimeout(s),l.onerror=null},d=function(){a&&(u(),i.unloadDel(c),l.parentNode.removeChild(l),l=a=null,CollectGarbage())},f=function(e){o(`onerror`,e),a&&(d(),n(e))},p=function(e,t){try{setTimeout(function(){l&&l.contentWindow&&l.contentWindow.postMessage(e,t)},0)}catch{}};a.open(),a.write(`<html><script>document.domain="`+r.document.domain+`";<\/script></html>`),a.close(),a.parentWindow[t.exports.WPrefix]=r[t.exports.WPrefix];var m=a.createElement(`div`);return a.body.appendChild(m),l=a.createElement(`iframe`),m.appendChild(l),l.src=e,l.onerror=function(){f(`onerror`)},s=setTimeout(function(){f(`timeout`)},15e3),c=i.unloadAdd(d),{post:p,cleanup:d,loaded:u}}},t.exports.iframeEnabled=!1,r.document&&(t.exports.iframeEnabled=(typeof r.postMessage==`function`||typeof r.postMessage==`object`)&&!a.isKonqueror())}).call(this)}).call(this,{env:{}},typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{"./browser":44,"./event":46,debug:55}],48:[function(e,t,n){(function(e){(function(){var n={};[`log`,`debug`,`warn`].forEach(function(t){var r;try{r=e.console&&e.console[t]&&e.console[t].apply}catch{}n[t]=r?function(){return e.console[t].apply(e.console,arguments)}:t===`log`?function(){}:n.log}),t.exports=n}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{}],49:[function(e,t,n){t.exports={isObject:function(e){var t=typeof e;return t===`function`||t===`object`&&!!e},extend:function(e){if(!this.isObject(e))return e;for(var t,n,r=1,i=arguments.length;r<i;r++)for(n in t=arguments[r],t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}}},{}],50:[function(e,t,n){var r=e(`crypto`),i=`abcdefghijklmnopqrstuvwxyz012345`;t.exports={string:function(e){for(var t=i.length,n=r.randomBytes(e),a=[],o=0;o<e;o++)a.push(i.substr(n[o]%t,1));return a.join(``)},number:function(e){return Math.floor(Math.random()*e)},numberString:function(e){var t=(``+(e-1)).length;return(Array(t+1).join(`0`)+this.number(e)).slice(-t)}}},{crypto:43}],51:[function(e,t,n){(function(n){(function(){var r=function(){};n.env.NODE_ENV!==`production`&&(r=e(`debug`)(`sockjs-client:utils:transport`)),t.exports=function(e){return{filterToEnabled:function(t,n){var i={main:[],facade:[]};return t?typeof t==`string`&&(t=[t]):t=[],e.forEach(function(e){if(e){if(e.transportName===`websocket`&&n.websocket===!1){r(`disabled from server`,`websocket`);return}if(t.length&&t.indexOf(e.transportName)===-1){r(`not in whitelist`,e.transportName);return}e.enabled(n)?(r(`enabled`,e.transportName),i.main.push(e),e.facadeTransport&&i.facade.push(e.facadeTransport)):r(`disabled`,e.transportName)}}),i}}}}).call(this)}).call(this,{env:{}})},{debug:55}],52:[function(e,t,n){(function(n){(function(){var r=e(`url-parse`),i=function(){};n.env.NODE_ENV!==`production`&&(i=e(`debug`)(`sockjs-client:utils:url`)),t.exports={getOrigin:function(e){if(!e)return null;var t=new r(e);if(t.protocol===`file:`)return null;var n=t.port;return n||=t.protocol===`https:`?`443`:`80`,t.protocol+`//`+t.hostname+`:`+n},isOriginEqual:function(e,t){var n=this.getOrigin(e)===this.getOrigin(t);return i(`same`,e,t,n),n},isSchemeEqual:function(e,t){return e.split(`:`)[0]===t.split(`:`)[0]},addPath:function(e,t){var n=e.split(`?`);return n[0]+t+(n[1]?`?`+n[1]:``)},addQuery:function(e,t){return e+(e.indexOf(`?`)===-1?`?`+t:`&`+t)},isLoopbackAddr:function(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^\[::1\]$/.test(e)}}}).call(this)}).call(this,{env:{}})},{debug:55,"url-parse":60}],53:[function(e,t,n){t.exports=`1.6.1`},{}],54:[function(e,t,n){var r=1e3,i=r*60,a=i*60,o=a*24,s=o*7,c=o*365.25;t.exports=function(e,t){t||={};var n=typeof e;if(n===`string`&&e.length>0)return l(e);if(n===`number`&&isFinite(e))return t.long?d(e):u(e);throw Error(`val is not a non-empty string or a valid number. val=`+JSON.stringify(e))};function l(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||`ms`).toLowerCase()){case`years`:case`year`:case`yrs`:case`yr`:case`y`:return n*c;case`weeks`:case`week`:case`w`:return n*s;case`days`:case`day`:case`d`:return n*o;case`hours`:case`hour`:case`hrs`:case`hr`:case`h`:return n*a;case`minutes`:case`minute`:case`mins`:case`min`:case`m`:return n*i;case`seconds`:case`second`:case`secs`:case`sec`:case`s`:return n*r;case`milliseconds`:case`millisecond`:case`msecs`:case`msec`:case`ms`:return n;default:return}}}}function u(e){var t=Math.abs(e);return t>=o?Math.round(e/o)+`d`:t>=a?Math.round(e/a)+`h`:t>=i?Math.round(e/i)+`m`:t>=r?Math.round(e/r)+`s`:e+`ms`}function d(e){var t=Math.abs(e);return t>=o?f(e,t,o,`day`):t>=a?f(e,t,a,`hour`):t>=i?f(e,t,i,`minute`):t>=r?f(e,t,r,`second`):e+` ms`}function f(e,t,n,r){var i=t>=n*1.5;return Math.round(e/n)+` `+r+(i?`s`:``)}},{}],55:[function(e,t,n){(function(r){(function(){n.formatArgs=a,n.save=o,n.load=s,n.useColors=i,n.storage=c(),n.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=`#0000CC.#0000FF.#0033CC.#0033FF.#0066CC.#0066FF.#0099CC.#0099FF.#00CC00.#00CC33.#00CC66.#00CC99.#00CCCC.#00CCFF.#3300CC.#3300FF.#3333CC.#3333FF.#3366CC.#3366FF.#3399CC.#3399FF.#33CC00.#33CC33.#33CC66.#33CC99.#33CCCC.#33CCFF.#6600CC.#6600FF.#6633CC.#6633FF.#66CC00.#66CC33.#9900CC.#9900FF.#9933CC.#9933FF.#99CC00.#99CC33.#CC0000.#CC0033.#CC0066.#CC0099.#CC00CC.#CC00FF.#CC3300.#CC3333.#CC3366.#CC3399.#CC33CC.#CC33FF.#CC6600.#CC6633.#CC9900.#CC9933.#CCCC00.#CCCC33.#FF0000.#FF0033.#FF0066.#FF0099.#FF00CC.#FF00FF.#FF3300.#FF3333.#FF3366.#FF3399.#FF33CC.#FF33FF.#FF6600.#FF6633.#FF9900.#FF9933.#FFCC00.#FFCC33`.split(`.`);function i(){return typeof window<`u`&&window.process&&(window.process.type===`renderer`||window.process.__nwjs)?!0:typeof navigator<`u`&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<`u`&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<`u`&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<`u`&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<`u`&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(e){if(e[0]=(this.useColors?`%c`:``)+this.namespace+(this.useColors?` %c`:` `)+e[0]+(this.useColors?`%c `:` `)+`+`+t.exports.humanize(this.diff),!this.useColors)return;let n=`color: `+this.color;e.splice(1,0,n,`color: inherit`);let r=0,i=0;e[0].replace(/%[a-zA-Z%]/g,e=>{e!==`%%`&&(r++,e===`%c`&&(i=r))}),e.splice(i,0,n)}n.log=console.debug||console.log||(()=>{});function o(e){try{e?n.storage.setItem(`debug`,e):n.storage.removeItem(`debug`)}catch{}}function s(){let e;try{e=n.storage.getItem(`debug`)}catch{}return!e&&r!==void 0&&`env`in r&&(e=r.env.DEBUG),e}function c(){try{return localStorage}catch{}}t.exports=e(`./common`)(n);let{formatters:l}=t.exports;l.j=function(e){try{return JSON.stringify(e)}catch(e){return`[UnexpectedJSONParseError]: `+e.message}}}).call(this)}).call(this,{env:{}})},{"./common":56}],56:[function(e,t,n){function r(t){r.debug=r,r.default=r,r.coerce=l,r.disable=o,r.enable=a,r.enabled=s,r.humanize=e(`ms`),r.destroy=u,Object.keys(t).forEach(e=>{r[e]=t[e]}),r.names=[],r.skips=[],r.formatters={};function n(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}r.selectColor=n;function r(e){let t,n=null,a,o;function s(...e){if(!s.enabled)return;let n=s,i=Number(new Date);n.diff=i-(t||i),n.prev=t,n.curr=i,t=i,e[0]=r.coerce(e[0]),typeof e[0]!=`string`&&e.unshift(`%O`);let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(t,i)=>{if(t===`%%`)return`%`;a++;let o=r.formatters[i];if(typeof o==`function`){let r=e[a];t=o.call(n,r),e.splice(a,1),a--}return t}),r.formatArgs.call(n,e),(n.log||r.log).apply(n,e)}return s.namespace=e,s.useColors=r.useColors(),s.color=r.selectColor(e),s.extend=i,s.destroy=r.destroy,Object.defineProperty(s,`enabled`,{enumerable:!0,configurable:!1,get:()=>n===null?(a!==r.namespaces&&(a=r.namespaces,o=r.enabled(e)),o):n,set:e=>{n=e}}),typeof r.init==`function`&&r.init(s),s}function i(e,t){let n=r(this.namespace+(t===void 0?`:`:t)+e);return n.log=this.log,n}function a(e){r.save(e),r.namespaces=e,r.names=[],r.skips=[];let t,n=(typeof e==`string`?e:``).split(/[\s,]+/),i=n.length;for(t=0;t<i;t++)n[t]&&(e=n[t].replace(/\*/g,`.*?`),e[0]===`-`?r.skips.push(RegExp(`^`+e.substr(1)+`$`)):r.names.push(RegExp(`^`+e+`$`)))}function o(){let e=[...r.names.map(c),...r.skips.map(c).map(e=>`-`+e)].join(`,`);return r.enable(``),e}function s(e){if(e[e.length-1]===`*`)return!0;let t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1}function c(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,`*`)}function l(e){return e instanceof Error?e.stack||e.message:e}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}t.exports=r},{ms:54}],57:[function(e,t,n){typeof Object.create==`function`?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},{}],58:[function(e,t,n){var r=Object.prototype.hasOwnProperty,i;function a(e){try{return decodeURIComponent(e.replace(/\+/g,` `))}catch{return null}}function o(e){for(var t=/([^=?&]+)=?([^&]*)/g,n={},r;r=t.exec(e);){var i=a(r[1]),o=a(r[2]);i===null||o===null||i in n||(n[i]=o)}return n}function s(e,t){t||=``;var n=[],a,o;for(o in typeof t!=`string`&&(t=`?`),e)if(r.call(e,o)){if(a=e[o],!a&&(a===null||a===i||isNaN(a))&&(a=``),o=encodeURIComponent(o),a=encodeURIComponent(a),o===null||a===null)continue;n.push(o+`=`+a)}return n.length?t+n.join(`&`):``}n.stringify=s,n.parse=o},{}],59:[function(e,t,n){t.exports=function(e,t){if(t=t.split(`:`)[0],e=+e,!e)return!1;switch(t){case`http`:case`ws`:return e!==80;case`https`:case`wss`:return e!==443;case`ftp`:return e!==21;case`gopher`:return e!==70;case`file`:return!1}return e!==0}},{}],60:[function(e,t,n){(function(n){(function(){var r=e(`requires-port`),i=e(`querystringify`),a=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o=/[\n\r\t]/g,s=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/:\d+$/,l=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,u=/^[a-zA-Z]:/;function d(e){return(e||``).toString().replace(a,``)}var f=[[`#`,`hash`],[`?`,`query`],function(e,t){return h(t.protocol)?e.replace(/\\/g,`/`):e},[`/`,`pathname`],[`@`,`auth`,1],[NaN,`host`,void 0,1,1],[/:(\d*)$/,`port`,void 0,1],[NaN,`hostname`,void 0,1,1]],p={hash:1,query:1};function m(e){var t=(typeof window<`u`?window:n===void 0?typeof self<`u`?self:{}:n).location||{};e||=t;var r={},i=typeof e,a;if(e.protocol===`blob:`)r=new v(unescape(e.pathname),{});else if(i===`string`)for(a in r=new v(e,{}),p)delete r[a];else if(i===`object`){for(a in e)a in p||(r[a]=e[a]);r.slashes===void 0&&(r.slashes=s.test(e.href))}return r}function h(e){return e===`file:`||e===`ftp:`||e===`http:`||e===`https:`||e===`ws:`||e===`wss:`}function g(e,t){e=d(e),e=e.replace(o,``),t||={};var n=l.exec(e),r=n[1]?n[1].toLowerCase():``,i=!!n[2],a=!!n[3],s=0,c;return i?a?(c=n[2]+n[3]+n[4],s=n[2].length+n[3].length):(c=n[2]+n[4],s=n[2].length):a?(c=n[3]+n[4],s=n[3].length):c=n[4],r===`file:`?s>=2&&(c=c.slice(2)):h(r)?c=n[4]:r?i&&(c=c.slice(2)):s>=2&&h(t.protocol)&&(c=n[4]),{protocol:r,slashes:i||h(r),slashesCount:s,rest:c}}function _(e,t){if(e===``)return t;for(var n=(t||`/`).split(`/`).slice(0,-1).concat(e.split(`/`)),r=n.length,i=n[r-1],a=!1,o=0;r--;)n[r]===`.`?n.splice(r,1):n[r]===`..`?(n.splice(r,1),o++):o&&(r===0&&(a=!0),n.splice(r,1),o--);return a&&n.unshift(``),(i===`.`||i===`..`)&&n.push(``),n.join(`/`)}function v(e,t,n){if(e=d(e),e=e.replace(o,``),!(this instanceof v))return new v(e,t,n);var a,s,c,l,p,y,b=f.slice(),x=typeof t,S=this,C=0;for(x!==`object`&&x!==`string`&&(n=t,t=null),n&&typeof n!=`function`&&(n=i.parse),t=m(t),s=g(e||``,t),a=!s.protocol&&!s.slashes,S.slashes=s.slashes||a&&t.slashes,S.protocol=s.protocol||t.protocol||``,e=s.rest,(s.protocol===`file:`&&(s.slashesCount!==2||u.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!h(S.protocol)))&&(b[3]=[/(.*)/,`pathname`]);C<b.length;C++){if(l=b[C],typeof l==`function`){e=l(e,S);continue}c=l[0],y=l[1],c===c?typeof c==`string`?(p=c===`@`?e.lastIndexOf(c):e.indexOf(c),~p&&(typeof l[2]==`number`?(S[y]=e.slice(0,p),e=e.slice(p+l[2])):(S[y]=e.slice(p),e=e.slice(0,p)))):(p=c.exec(e))&&(S[y]=p[1],e=e.slice(0,p.index)):S[y]=e,S[y]=S[y]||a&&l[3]&&t[y]||``,l[4]&&(S[y]=S[y].toLowerCase())}n&&(S.query=n(S.query)),a&&t.slashes&&S.pathname.charAt(0)!==`/`&&(S.pathname!==``||t.pathname!==``)&&(S.pathname=_(S.pathname,t.pathname)),S.pathname.charAt(0)!==`/`&&h(S.protocol)&&(S.pathname=`/`+S.pathname),r(S.port,S.protocol)||(S.host=S.hostname,S.port=``),S.username=S.password=``,S.auth&&=(p=S.auth.indexOf(`:`),~p?(S.username=S.auth.slice(0,p),S.username=encodeURIComponent(decodeURIComponent(S.username)),S.password=S.auth.slice(p+1),S.password=encodeURIComponent(decodeURIComponent(S.password))):S.username=encodeURIComponent(decodeURIComponent(S.auth)),S.password?S.username+`:`+S.password:S.username),S.origin=S.protocol!==`file:`&&h(S.protocol)&&S.host?S.protocol+`//`+S.host:`null`,S.href=S.toString()}function y(e,t,n){var a=this;switch(e){case`query`:typeof t==`string`&&t.length&&(t=(n||i.parse)(t)),a[e]=t;break;case`port`:a[e]=t,r(t,a.protocol)?t&&(a.host=a.hostname+`:`+t):(a.host=a.hostname,a[e]=``);break;case`hostname`:a[e]=t,a.port&&(t+=`:`+a.port),a.host=t;break;case`host`:a[e]=t,c.test(t)?(t=t.split(`:`),a.port=t.pop(),a.hostname=t.join(`:`)):(a.hostname=t,a.port=``);break;case`protocol`:a.protocol=t.toLowerCase(),a.slashes=!n;break;case`pathname`:case`hash`:if(t){var o=e===`pathname`?`/`:`#`;a[e]=t.charAt(0)===o?t:o+t}else a[e]=t;break;case`username`:case`password`:a[e]=encodeURIComponent(t);break;case`auth`:var s=t.indexOf(`:`);~s?(a.username=t.slice(0,s),a.username=encodeURIComponent(decodeURIComponent(a.username)),a.password=t.slice(s+1),a.password=encodeURIComponent(decodeURIComponent(a.password))):a.username=encodeURIComponent(decodeURIComponent(t))}for(var l=0;l<f.length;l++){var u=f[l];u[4]&&(a[u[1]]=a[u[1]].toLowerCase())}return a.auth=a.password?a.username+`:`+a.password:a.username,a.origin=a.protocol!==`file:`&&h(a.protocol)&&a.host?a.protocol+`//`+a.host:`null`,a.href=a.toString(),a}function b(e){(!e||typeof e!=`function`)&&(e=i.stringify);var t,n=this,r=n.host,a=n.protocol;a&&a.charAt(a.length-1)!==`:`&&(a+=`:`);var o=a+(n.protocol&&n.slashes||h(n.protocol)?`//`:``);return n.username?(o+=n.username,n.password&&(o+=`:`+n.password),o+=`@`):n.password?(o+=`:`+n.password,o+=`@`):n.protocol!==`file:`&&h(n.protocol)&&!r&&n.pathname!==`/`&&(o+=`@`),(r[r.length-1]===`:`||c.test(n.hostname)&&!n.port)&&(r+=`:`),o+=r+n.pathname,t=typeof n.query==`object`?e(n.query):n.query,t&&(o+=t.charAt(0)===`?`?t:`?`+t),n.hash&&(o+=n.hash),o}v.prototype={set:y,toString:b},v.extractProtocol=g,v.location=m,v.trimLeft=d,v.qs=i,t.exports=v}).call(this)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{querystringify:58,"requires-port":59}]},{},[1])(1)})})),g=s((e=>{(function(){var t,n,r,i,a={}.hasOwnProperty,o=[].slice;t={LF:`
`,NULL:`\0`},r=(function(){var e;function n(e,t,n){this.command=e,this.headers=t??{},this.body=n??``}return n.prototype.toString=function(){var e=[this.command],r,i=this.headers[`content-length`]===!1,o,s;for(r in i&&delete this.headers[`content-length`],s=this.headers,s)a.call(s,r)&&(o=s[r],e.push(``+r+`:`+o));return this.body&&!i&&e.push(`content-length:`+n.sizeOfUTF8(this.body)),e.push(t.LF+this.body),e.join(t.LF)},n.sizeOfUTF8=function(e){return e?encodeURI(e).match(/%..|./g).length:0},e=function(e){var r,i,a,o=e.search(RegExp(``+t.LF+t.LF)),s=e.substring(0,o).split(t.LF),c,l,u,d,f,p,m,h,g,_,v,y;for(a=s.shift(),c={},m=function(e){return e.replace(/^\s+|\s+$/g,``)},v=s.reverse(),h=0,_=v.length;h<_;h++)f=v[h],u=f.indexOf(`:`),c[m(f.substring(0,u))]=m(f.substring(u+1));if(r=``,p=o+2,c[`content-length`])d=parseInt(c[`content-length`]),r=(``+e).substring(p,p+d);else for(i=null,l=g=p,y=e.length;(p<=y?g<y:g>y)&&(i=e.charAt(l),i!==t.NULL);l=p<=y?++g:--g)r+=i;return new n(a,c,r)},n.unmarshall=function(n){var r;return(function(){var i,a,o=n.split(RegExp(``+t.NULL+t.LF+`*`)),s=[];for(i=0,a=o.length;i<a;i++)r=o[i],r?.length>0&&s.push(e(r));return s})()},n.marshall=function(e,r,i){return new n(e,r,i).toString()+t.NULL},n})(),n=(function(){var e;function n(e){this.ws=e,this.ws.binaryType=`arraybuffer`,this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16*1024,this.subscriptions={}}return n.prototype.debug=function(e){return typeof window<`u`&&window!==null?window.console?.log(e):void 0},e=function(){return Date.now?Date.now():new Date().valueOf},n.prototype._transmit=function(e,t,n){var i=r.marshall(e,t,n);for(typeof this.debug==`function`&&this.debug(`>>> `+i);;)if(i.length>this.maxWebSocketFrameSize)this.ws.send(i.substring(0,this.maxWebSocketFrameSize)),i=i.substring(this.maxWebSocketFrameSize),typeof this.debug==`function`&&this.debug(`remaining = `+i.length);else return this.ws.send(i)},n.prototype._setupHeartbeat=function(n){var r,a,o,s,c,l;if(!((c=n.version)!==i.VERSIONS.V1_1&&c!==i.VERSIONS.V1_2)&&(l=(function(){var e,t,r=n[`heart-beat`].split(`,`),i=[];for(e=0,t=r.length;e<t;e++)s=r[e],i.push(parseInt(s));return i})(),a=l[0],r=l[1],this.heartbeat.outgoing===0||r===0||(o=Math.max(this.heartbeat.outgoing,r),typeof this.debug==`function`&&this.debug(`send PING every `+o+`ms`),this.pinger=i.setInterval(o,(function(e){return function(){return e.ws.send(t.LF),typeof e.debug==`function`?e.debug(`>>> PING`):void 0}})(this))),!(this.heartbeat.incoming===0||a===0)))return o=Math.max(this.heartbeat.incoming,a),typeof this.debug==`function`&&this.debug(`check PONG every `+o+`ms`),this.ponger=i.setInterval(o,(function(t){return function(){var n=e()-t.serverActivity;if(n>o*2)return typeof t.debug==`function`&&t.debug(`did not receive server activity for the last `+n+`ms`),t.ws.close()}})(this))},n.prototype._parseConnect=function(){var e=1<=arguments.length?o.call(arguments,0):[],t,n,r={};switch(e.length){case 2:r=e[0],t=e[1];break;case 3:e[1]instanceof Function?(r=e[0],t=e[1],n=e[2]):(r.login=e[0],r.passcode=e[1],t=e[2]);break;case 4:r.login=e[0],r.passcode=e[1],t=e[2],n=e[3];break;default:r.login=e[0],r.passcode=e[1],t=e[2],n=e[3],r.host=e[4]}return[r,t,n]},n.prototype.connect=function(){var n=1<=arguments.length?o.call(arguments,0):[],a,s,c=this._parseConnect.apply(this,n);return s=c[0],this.connectCallback=c[1],a=c[2],typeof this.debug==`function`&&this.debug(`Opening Web Socket...`),this.ws.onmessage=(function(n){return function(i){var o,s,c,l=typeof ArrayBuffer<`u`&&i.data instanceof ArrayBuffer?(o=new Uint8Array(i.data),typeof n.debug==`function`&&n.debug(`--- got data length: `+o.length),(function(){var e,t,n=[];for(e=0,t=o.length;e<t;e++)s=o[e],n.push(String.fromCharCode(s));return n})().join(``)):i.data,u,d,f,p,m,h,g,_;if(n.serverActivity=e(),l===t.LF){typeof n.debug==`function`&&n.debug(`<<< PONG`);return}for(typeof n.debug==`function`&&n.debug(`<<< `+l),g=r.unmarshall(l),_=[],m=0,h=g.length;m<h;m++)switch(u=g[m],u.command){case`CONNECTED`:typeof n.debug==`function`&&n.debug(`connected to server `+u.headers.server),n.connected=!0,n._setupHeartbeat(u.headers),_.push(typeof n.connectCallback==`function`?n.connectCallback(u):void 0);break;case`MESSAGE`:p=u.headers.subscription,f=n.subscriptions[p]||n.onreceive,f?(c=n,d=u.headers[`message-id`],u.ack=function(e){return e??={},c.ack(d,p,e)},u.nack=function(e){return e??={},c.nack(d,p,e)},_.push(f(u))):_.push(typeof n.debug==`function`?n.debug(`Unhandled received MESSAGE: `+u):void 0);break;case`RECEIPT`:_.push(typeof n.onreceipt==`function`?n.onreceipt(u):void 0);break;case`ERROR`:_.push(typeof a==`function`?a(u):void 0);break;default:_.push(typeof n.debug==`function`?n.debug(`Unhandled frame: `+u):void 0)}return _}})(this),this.ws.onclose=(function(e){return function(){var t=`Whoops! Lost connection to `+e.ws.url;return typeof e.debug==`function`&&e.debug(t),e._cleanUp(),typeof a==`function`?a(t):void 0}})(this),this.ws.onopen=(function(e){return function(){return typeof e.debug==`function`&&e.debug(`Web Socket Opened...`),s[`accept-version`]=i.VERSIONS.supportedVersions(),s[`heart-beat`]=[e.heartbeat.outgoing,e.heartbeat.incoming].join(`,`),e._transmit(`CONNECT`,s)}})(this)},n.prototype.disconnect=function(e,t){return t??={},this._transmit(`DISCONNECT`,t),this.ws.onclose=null,this.ws.close(),this._cleanUp(),typeof e==`function`?e():void 0},n.prototype._cleanUp=function(){if(this.connected=!1,this.pinger&&i.clearInterval(this.pinger),this.ponger)return i.clearInterval(this.ponger)},n.prototype.send=function(e,t,n){return t??={},n??=``,t.destination=e,this._transmit(`SEND`,t,n)},n.prototype.subscribe=function(e,t,n){var r;return n??={},n.id||=`sub-`+ this.counter++,n.destination=e,this.subscriptions[n.id]=t,this._transmit(`SUBSCRIBE`,n),r=this,{id:n.id,unsubscribe:function(){return r.unsubscribe(n.id)}}},n.prototype.unsubscribe=function(e){return delete this.subscriptions[e],this._transmit(`UNSUBSCRIBE`,{id:e})},n.prototype.begin=function(e){var t,n=e||`tx-`+ this.counter++;return this._transmit(`BEGIN`,{transaction:n}),t=this,{id:n,commit:function(){return t.commit(n)},abort:function(){return t.abort(n)}}},n.prototype.commit=function(e){return this._transmit(`COMMIT`,{transaction:e})},n.prototype.abort=function(e){return this._transmit(`ABORT`,{transaction:e})},n.prototype.ack=function(e,t,n){return n??={},n[`message-id`]=e,n.subscription=t,this._transmit(`ACK`,n)},n.prototype.nack=function(e,t,n){return n??={},n[`message-id`]=e,n.subscription=t,this._transmit(`NACK`,n)},n})(),i={VERSIONS:{V1_0:`1.0`,V1_1:`1.1`,V1_2:`1.2`,supportedVersions:function(){return`1.1,1.0`}},client:function(e,t){var r,a;return t??=[`v10.stomp`,`v11.stomp`],r=i.WebSocketClass||WebSocket,a=new r(e,t),new n(a)},over:function(e){return new n(e)},Frame:r},e!=null&&(e.Stomp=i),typeof window<`u`&&window!==null?(i.setInterval=function(e,t){return window.setInterval(t,e)},i.clearInterval=function(e){return window.clearInterval(e)},window.Stomp=i):e||(self.Stomp=i)}).call(e)})),_=s(((e,t)=>{t.exports={}})),v=s(((e,t)=>{var n=function(){if(typeof self==`object`&&self)return self;if(typeof window==`object`&&window)return window;throw Error("Unable to resolve global `this`")};t.exports=(function(){if(this)return this;if(typeof globalThis==`object`&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,`__global__`,{get:function(){return this},configurable:!0})}catch{return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}})()})),y=i({author:()=>C,browser:()=>F,config:()=>j,contributors:()=>w,default:()=>L,dependencies:()=>k,description:()=>x,devDependencies:()=>A,directories:()=>P,engines:()=>O,homepage:()=>D,keywords:()=>S,license:()=>I,main:()=>N,name:()=>b,repository:()=>E,scripts:()=>M,version:()=>T}),b,x,S,C,w,T,E,D,O,k,A,j,M,N,P,F,I,L,R=l((()=>{b=`websocket`,x=`Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.`,S=[`websocket`,`websockets`,`socket`,`networking`,`comet`,`push`,`RFC-6455`,`realtime`,`server`,`client`],C=`Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)`,w=[`Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)`],T=`1.0.35`,E={type:`git`,url:`https://github.com/theturtle32/WebSocket-Node.git`},D=`https://github.com/theturtle32/WebSocket-Node`,O={node:`>=4.0.0`},k={bufferutil:`^4.0.1`,debug:`^2.2.0`,"es5-ext":`^0.10.63`,"typedarray-to-buffer":`^3.1.5`,"utf-8-validate":`^5.0.2`,yaeti:`^0.0.6`},A={"buffer-equal":`^1.0.0`,gulp:`^4.0.2`,"gulp-jshint":`^2.0.4`,"jshint-stylish":`^2.2.1`,jshint:`^2.0.0`,tape:`^4.9.1`},j={verbose:!1},M={test:`tape test/unit/*.js`,gulp:`gulp`},N=`index`,P={lib:`./lib`},F=`lib/browser.js`,I=`Apache-2.0`,L={name:b,description:x,keywords:S,author:C,contributors:w,version:T,repository:E,homepage:D,engines:O,dependencies:k,devDependencies:A,config:j,scripts:M,main:N,directories:P,browser:F,license:I}})),z=s(((e,t)=>{t.exports=(R(),u(y).default).version})),B=s(((e,t)=>{var n;if(typeof globalThis==`object`)n=globalThis;else try{n=v()}catch{}finally{if(!n&&typeof window<`u`&&(n=window),!n)throw Error(`Could not determine global this`)}var r=n.WebSocket||n.MozWebSocket,i=z();function a(e,t){return t?new r(e,t):new r(e)}r&&[`CONNECTING`,`OPEN`,`CLOSING`,`CLOSED`].forEach(function(e){Object.defineProperty(a,e,{get:function(){return r[e]}})}),t.exports={w3cwebsocket:r?a:null,version:i}})),V=s((e=>{(function(){var t=g(),n=_(),r,i,a,o;t.Stomp.setInterval=function(e,t){return setInterval(t,e)},t.Stomp.clearInterval=function(e){return clearInterval(e)},a=function(e,t){var r=null,i={url:`tcp:// `+t+`:`+e,send:function(e){return r.write(e)},close:function(){return r.end()}};return r=n.connect(e,t,function(e){return i.onopen()}),r.on(`error`,function(e){return typeof i.onclose==`function`?i.onclose(e):void 0}),r.on(`close`,function(e){return typeof i.onclose==`function`?i.onclose(e):void 0}),r.on(`data`,function(e){var t={data:e.toString()};return i.onmessage(t)}),i},o=function(e){var t=B().client,n=null,r,i={url:e,send:function(e){return n.sendUTF(e)},close:function(){return n.close()}};return r=new t,r.on(`connect`,function(e){return n=e,i.onopen(),n.on(`error`,function(e){return typeof i.onclose==`function`?i.onclose(e):void 0}),n.on(`close`,function(){return typeof i.onclose==`function`?i.onclose():void 0}),n.on(`message`,function(e){var t;if(e.type===`utf8`)return t={data:e.utf8Data},i.onmessage(t)})}),r.connect(e),i},r=function(e,n){var r=a(n,e);return t.Stomp.over(r)},i=function(e){var n=o(e);return t.Stomp.over(n)},e.overTCP=r,e.overWS=i}).call(e)})),H=s(((e,t)=>{var n=g(),r=V();t.exports=n.Stomp,t.exports.overTCP=r.overTCP,t.exports.overWS=r.overWS})),U=p(c(),1),W=p(o(),1),G=p(h(),1),K=p(H(),1),q=p(n(),1),J=`https://be2.flaboratory.cloud`;function Y({open:t,onClose:n,itemId:i,itemType:a=`testOrder`,onCommentAdded:o}){let[s,c]=(0,U.useState)([]),[l,u]=(0,U.useState)(``),[p,h]=(0,U.useState)(!1),[g,_]=(0,U.useState)(!1),[v,y]=(0,U.useState)(null),[b,x]=(0,U.useState)(null),[S,C]=(0,U.useState)(``),[w,T]=(0,U.useState)(null),E=(0,U.useRef)(null),{user:D}=d()||{};console.log(`FE - raw user from useAuth:`,D);let O=(0,U.useRef)(null),k=a===`testOrder`?i:v,A=()=>{if(!k)return;let e=new G.default(`${J}/ws`),t=K.default.over(e);t.connect({},()=>{t.subscribe(`/topic/comments/${k}`,e=>{let t=JSON.parse(e.body);t.type===`created`&&c(e=>[...e,t.data]),t.type===`updated`&&c(e=>e.map(e=>e.id===t.data.id?t.data:e)),t.type===`deleted`&&c(e=>e.filter(e=>e.id!==t.data.id))})}),O.current=t},j=e=>{if(!e)return`Unknown`;let t=e.toLowerCase();return t.includes(`manager`)?`Lab Manager`:t.includes(`tech`)?`Lab Technician`:`Unknown`},M=(()=>({role:D?.roles?.[0]||`lab_tech`,userId:D?.id||D?.raw?.userId||null}))(),N=M.role.toLowerCase(),P=N.includes(`manager`)||N.includes(`tech`),F=async(e,t={})=>{let n=localStorage.getItem(`lm.access`);return r({url:`${J}${e}`,...t,headers:{Authorization:n?`Bearer ${n}`:void 0,"Content-Type":`application/json`,...t.headers},withCredentials:!0})},I=async()=>{if(i)try{h(!0),T(null);let e=[],t=null;if(a===`testOrder`)e=(await F(`/api/v1/test-orders/${i}`)).data.comments||[];else if(a===`testResult`){let n=(await F(`/api/v1/test-results/by-item/${i}`)).data;Array.isArray(n)&&n.length>0&&(t=n[0].id,e=n[0].comments||[])}c(e),y(t)}catch{W.default.fire(`Error`,`Failed to load comments`,`error`)}finally{h(!1)}};(0,U.useEffect)(()=>{t&&i&&I()},[t,i,a]),(0,U.useEffect)(()=>{if(t)return k&&A(),()=>{O.current&&O.current.disconnect()}},[k,t]),(0,U.useEffect)(()=>{E.current?.scrollIntoView({behavior:`smooth`})},[s]);let L=async()=>{if(!P){W.default.fire(`Not allowed`,`You don't have permission to comment.`,`error`);return}if(!l.trim()){W.default.fire(`Warning`,`Please enter a message`,`warning`);return}try{_(!0);let e={commentText:l.trim()};a===`testOrder`?e.testOrderId=i:a===`testResult`&&(e.testResultId=v),await F(`/api/v1/comments`,{method:`POST`,data:e}),u(``),o&&o()}catch(e){W.default.fire(`Error`,e.response?.data?.message||`Failed to add comment`,`error`)}finally{_(!1)}},R=e=>{let t=e.createdBy?.id,n=t===M.userId;if(!t||!n){W.default.fire(`Not allowed`,`You can only edit your own messages.`,`error`);return}x(e.id),C(e.commentText),T(null)},z=async()=>{if(!S.trim()){W.default.fire(`Warning`,`Please enter a message`,`warning`);return}try{await F(`/api/v1/comments/${b}`,{method:`PUT`,data:{commentText:S.trim()}}),x(null),C(``),W.default.fire({toast:!0,position:`top-end`,timer:2e3,showConfirmButton:!1,icon:`success`,title:`Comment updated!`})}catch(e){W.default.fire(`Error`,e.response?.data?.message||`Failed to update comment`,`error`)}},B=async(e,t)=>{let n=t?.id,r=n===M.userId;if(!n||!r){W.default.fire(`Not allowed`,`You can only delete your own messages.`,`error`);return}if((await W.default.fire({title:`Delete comment?`,icon:`warning`,showCancelButton:!0,confirmButtonColor:`#ef4444`})).isConfirmed)try{await F(`/api/v1/comments/${e}`,{method:`DELETE`})}catch(e){W.default.fire(`Error`,e.response?.data?.message||`Failed to delete comment`,`error`)}},V=e=>e?new Date(e).toLocaleString(`en-US`,{month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`}):``;return t?(0,q.jsx)(`div`,{className:`fixed inset-0 bg-black/30 backdrop-blur-sm flex justify-center items-center z-50`,children:(0,q.jsxs)(`div`,{className:`bg-white rounded-lg shadow-2xl w-full max-w-2xl h-96 flex flex-col`,children:[(0,q.jsxs)(`div`,{className:`flex justify-between items-center p-4 border-b`,children:[(0,q.jsx)(`h2`,{className:`text-xl font-semibold text-gray-800`,children:` Comments & Discussion`}),(0,q.jsx)(`button`,{onClick:n,className:`p-1 hover:bg-gray-100 rounded-md`,children:(0,q.jsx)(f,{className:`w-5 h-5 text-gray-500`})})]}),(0,q.jsxs)(`div`,{className:`flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50`,children:[p?(0,q.jsxs)(`div`,{className:`flex items-center justify-center py-8`,children:[(0,q.jsx)(e,{className:`w-6 h-6 animate-spin text-cyan-600`}),(0,q.jsx)(`span`,{className:`ml-2 text-gray-600`,children:`Loading comments...`})]}):s.length===0?(0,q.jsx)(`div`,{className:`text-center text-gray-400 py-8`,children:`No comments yet.`}):s.map(e=>{let t=e.createdBy||{},n=t.id===M.userId;console.log(`CHECK OWN:`,`commentId =`,e.id,`| createdBy.id =`,t.id,`| currentUserId =`,M.userId,`| isOwn =`,n);let r=t.displayName||t.username||j(t.roles?.[0]||M.role);return(0,q.jsxs)(`div`,{className:`flex items-start gap-1 ${n?`justify-end`:`justify-start`}`,children:[n&&(0,q.jsxs)(`div`,{className:`relative pt-2 ${n?`order-last`:`order-first`}`,children:[(0,q.jsx)(`button`,{onClick:()=>T(w===e.id?null:e.id),className:`p-1 text-gray-400 hover:bg-gray-200 rounded-full`,children:(0,q.jsx)(m,{className:`w-4 h-4`})}),w===e.id&&(0,q.jsxs)(`div`,{className:`absolute ${n?`right-0`:`left-0`} top-10 bg-white border border-gray-200 rounded-lg shadow-lg w-32 z-10 overflow-hidden`,children:[(0,q.jsx)(`button`,{onClick:()=>R(e),className:`block w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100`,children:`Edit`}),(0,q.jsx)(`button`,{onClick:()=>B(e.id,e.createdBy),className:`block w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50`,children:`Delete`})]})]}),(0,q.jsxs)(`div`,{className:`max-w-xs px-4 py-2 rounded-xl shadow-sm ${n?`bg-cyan-100 text-cyan-900 rounded-br-none`:`bg-white text-gray-900 border border-gray-200 rounded-bl-none`}`,children:[(0,q.jsxs)(`div`,{className:n?`mb-1 text-right`:`mb-1 text-left`,children:[(0,q.jsx)(`p`,{className:`text-xs font-semibold`,children:n?`You`:r}),(0,q.jsx)(`p`,{className:`text-xs text-gray-500`,children:V(e.createdAt)})]}),b===e.id?(0,q.jsxs)(`div`,{className:`mt-2 flex flex-col gap-2`,children:[(0,q.jsx)(`textarea`,{value:S,onChange:e=>C(e.target.value),className:`border rounded-lg p-2 text-sm w-full focus:ring-2 focus:ring-cyan-500 resize-none`,rows:`2`}),(0,q.jsxs)(`div`,{className:`flex justify-end gap-2`,children:[(0,q.jsx)(`button`,{onClick:z,disabled:!S.trim(),className:`px-3 py-1 text-xs bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50`,children:`Save`}),(0,q.jsx)(`button`,{onClick:()=>x(null),className:`px-3 py-1 text-xs bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300`,children:`Cancel`})]})]}):(0,q.jsx)(`p`,{className:`text-sm break-words`,children:e.commentText})]})]},e.id)}),(0,q.jsx)(`div`,{ref:E})]}),(0,q.jsx)(`div`,{className:`border-t p-4 bg-white`,children:(0,q.jsxs)(`div`,{className:`flex gap-2`,children:[(0,q.jsx)(`input`,{type:`text`,placeholder:P?`Type your message...`:`You don't have permission to comment`,value:l,onChange:e=>u(e.target.value),onKeyDown:e=>{e.key===`Enter`&&!g&&L()},disabled:g||!P||!!b,className:`flex-1 border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-cyan-500 disabled:bg-gray-100`}),(0,q.jsx)(`button`,{onClick:L,disabled:g||!l.trim()||!P||!!b,className:`px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 disabled:opacity-50 flex items-center gap-2 text-sm`,children:g?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(e,{className:`w-4 h-4 animate-spin`}),`Sending...`]}):`Send`})]})})]})}):null}export{Y as t};