import{t as e}from"./circle-check-T5Aj_NOH.js";import{t}from"./shield-check-BA-HeaCP.js";import{A as n,H as r,K as i,L as a,M as o,Y as s,d as c,h as l,j as u,m as d,tt as f,y as p,z as m}from"./index-BK-GGJM4.js";var h=f(s(),1),g=f(n(),1);function _(){let{t:n}=i(),[s,f]=(0,h.useState)({currentPassword:``,newPassword:``,confirm:``}),[_,v]=(0,h.useState)(!1),[y,b]=(0,h.useState)({current:!1,new:!1,confirm:!1}),[x,S]=(0,h.useState)({currentPassword:null,newPassword:null,confirm:null}),[C,w]=(0,h.useState)(null),T=e=>{let{name:t,value:n}=e.target;f(e=>({...e,[t]:n})),S(e=>({...e,[t]:null})),w(null)},E=e=>{b(t=>({...t,[e]:!t[e]}))};function D(e){return{length:e.length>=8&&e.length<=128,uppercase:/[A-Z]/.test(e),lowercase:/[a-z]/.test(e),number:/[0-9]/.test(e)}}let O=(0,h.useMemo)(()=>D(s.newPassword||``),[s.newPassword]),k=(0,h.useMemo)(()=>Object.values(O).every(Boolean),[O]);function A(e,t=null){if(!e||typeof e!=`object`)return n(t===401?`errors.UNAUTHORIZED`:t===403?`errors.FORBIDDEN`:`errors.UNKNOWN_ERROR`);if(e.message&&typeof e.message==`string`){let t=e.message.trim();if(t&&!/^[A-Z0-9_]+$/.test(t)&&!/^[a-z0-9_]+$/.test(t))return t}let r=e.error||e.code||e.message||null;if(!r&&e.errors&&typeof e.errors==`object`)try{let t=Object.values(e.errors).flat();t.length&&(r=t[0])}catch{}if(r){let e=String(r).trim().toUpperCase(),t=n(`errors.${e}`,{defaultValue:``});if(t&&t!==`errors.${e}`)return t}return n(t===401?`errors.UNAUTHORIZED`:t===403?`errors.FORBIDDEN`:`errors.UNKNOWN_ERROR`)}return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(`style`,{children:`
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
        .fade-in { animation: fadeIn 0.5s ease-out; }
        .slide-in { animation: slideIn 0.3s ease-out; }
      `}),(0,g.jsxs)(`div`,{className:`fade-in`,children:[(0,g.jsxs)(`div`,{className:`flex items-center gap-3 mb-8`,children:[(0,g.jsx)(`div`,{className:`p-3 rounded-2xl bg-gradient-to-br from-emerald-500 to-sky-600`,children:(0,g.jsx)(t,{className:`w-8 h-8 text-white`})}),(0,g.jsxs)(`div`,{children:[(0,g.jsx)(`h1`,{className:`text-3xl font-bold bg-gradient-to-r from-emerald-600 to-sky-600 bg-clip-text text-transparent`,children:n(`profile.change_password_title`,{defaultValue:`Change Password`})}),(0,g.jsx)(`p`,{className:`text-sm text-gray-500 mt-1`,children:n(`profile.change_password_subtitle`,{defaultValue:`Update your password to keep your account secure`})})]})]}),(0,g.jsx)(`div`,{className:`w-full`,children:(0,g.jsxs)(`form`,{onSubmit:async e=>{if(e.preventDefault(),S({currentPassword:null,newPassword:null,confirm:null}),w(null),!s.currentPassword){m(n(`errors.PASSWORD_REQUIRED`));return}if(!k){m(n(`errors.WEAK_PASSWORD`));return}if(s.newPassword!==s.confirm){m(n(`errors.PASSWORD_SAME_AS_OLD`,{defaultValue:`Passwords do not match.`}));return}v(!0);try{await u.post(`/api/v1/profile/change-password`,{currentPassword:s.currentPassword,newPassword:s.newPassword},{meta:{suppressError:!0}}),r(n(`auth.password_reset_success`)),o();let e=a();window.location.href=e}catch(e){let t=e?.response,r=t?.data,i=A(r,t?.status??null)||n(`errors.UNKNOWN_ERROR`),a=!1;if(r&&typeof r==`object`){if(r.errors&&typeof r.errors==`object`){let e=r.errors.currentPassword||r.errors.current_password||r.errors.current||null;if(e){let t=Array.isArray(e)?e[0]:String(e);S(e=>({...e,currentPassword:t})),a=!0}}let e=String(r.error||r.code||r.message||``).toUpperCase()||``;if(/CURRENT_PASSWORD|INVALID_CURRENT|PASSWORD_INCORRECT|WRONG_PASSWORD/.test(e)){let e=n(`errors.INVALID_CURRENT_PASSWORD`,{defaultValue:`Current password is incorrect`});S(t=>({...t,currentPassword:e})),a=!0}}a||(m(i),w(i))}finally{v(!1)}},className:`space-y-6`,children:[(0,g.jsxs)(`div`,{className:`space-y-2`,children:[(0,g.jsxs)(`label`,{className:`block text-sm font-medium text-gray-700`,children:[n(`profile.current_password`,{defaultValue:`Current Password`}),` `,`*`]}),(0,g.jsxs)(`div`,{className:`relative`,children:[(0,g.jsx)(c,{className:`absolute left-3 top-3.5 w-5 h-5 text-gray-400 pointer-events-none`}),(0,g.jsx)(`input`,{type:y.current?`text`:`password`,name:`currentPassword`,value:s.currentPassword,onChange:T,required:!0,placeholder:n(`profile.current_password_placeholder`,{defaultValue:`Enter your current password`}),className:`w-full rounded-xl border-2 pl-10 pr-12 py-3 focus:outline-none transition-colors ${x.currentPassword?`border-red-300 focus:border-red-500`:`border-gray-200 focus:border-emerald-500`}`}),(0,g.jsx)(`button`,{type:`button`,onClick:()=>E(`current`),className:`absolute right-3 top-3.5 text-gray-400 hover:text-gray-600 transition-colors`,children:y.current?(0,g.jsx)(l,{className:`w-5 h-5`}):(0,g.jsx)(d,{className:`w-5 h-5`})})]}),x.currentPassword&&(0,g.jsxs)(`p`,{className:`text-sm text-red-600 flex items-center gap-1 slide-in mt-2`,children:[(0,g.jsx)(p,{className:`w-4 h-4`}),x.currentPassword]})]}),(0,g.jsxs)(`div`,{className:`space-y-2`,children:[(0,g.jsxs)(`label`,{className:`block text-sm font-medium text-gray-700`,children:[n(`profile.new_password`,{defaultValue:`New Password`}),` *`]}),(0,g.jsxs)(`div`,{className:`relative`,children:[(0,g.jsx)(c,{className:`absolute left-3 top-3.5 w-5 h-5 text-gray-400 pointer-events-none`}),(0,g.jsx)(`input`,{type:y.new?`text`:`password`,name:`newPassword`,value:s.newPassword,onChange:T,required:!0,placeholder:n(`profile.new_password_placeholder`,{defaultValue:`Enter your new password`}),className:`w-full rounded-xl border-2 border-gray-200 pl-10 pr-12 py-3 focus:border-emerald-500 focus:outline-none transition-colors`}),(0,g.jsx)(`button`,{type:`button`,onClick:()=>E(`new`),className:`absolute right-3 top-3.5 text-gray-400 hover:text-gray-600 transition-colors`,children:y.new?(0,g.jsx)(l,{className:`w-5 h-5`}):(0,g.jsx)(d,{className:`w-5 h-5`})})]}),s.newPassword&&(0,g.jsxs)(`div`,{className:`mt-3 p-4 bg-gray-50 rounded-xl space-y-2 slide-in`,children:[(0,g.jsx)(`p`,{className:`text-xs font-medium text-gray-700 mb-2`,children:n(`profile.password_requirements`,{defaultValue:`Password Requirements:`})}),(0,g.jsxs)(`div`,{className:`space-y-1.5`,children:[(0,g.jsxs)(`div`,{className:`flex items-center gap-2 text-sm`,children:[O.length?(0,g.jsx)(e,{className:`w-4 h-4 text-emerald-500`}):(0,g.jsx)(p,{className:`w-4 h-4 text-gray-400`}),(0,g.jsx)(`span`,{className:O.length?`text-emerald-700`:`text-gray-600`,children:n(`profile.req_length`,{defaultValue:`Between 8 and 128 characters`})})]}),(0,g.jsxs)(`div`,{className:`flex items-center gap-2 text-sm`,children:[O.uppercase?(0,g.jsx)(e,{className:`w-4 h-4 text-emerald-500`}):(0,g.jsx)(p,{className:`w-4 h-4 text-gray-400`}),(0,g.jsx)(`span`,{className:O.uppercase?`text-emerald-700`:`text-gray-600`,children:n(`profile.req_uppercase`,{defaultValue:`One uppercase letter`})})]}),(0,g.jsxs)(`div`,{className:`flex items-center gap-2 text-sm`,children:[O.lowercase?(0,g.jsx)(e,{className:`w-4 h-4 text-emerald-500`}):(0,g.jsx)(p,{className:`w-4 h-4 text-gray-400`}),(0,g.jsx)(`span`,{className:O.lowercase?`text-emerald-700`:`text-gray-600`,children:n(`profile.req_lowercase`,{defaultValue:`One lowercase letter`})})]}),(0,g.jsxs)(`div`,{className:`flex items-center gap-2 text-sm`,children:[O.number?(0,g.jsx)(e,{className:`w-4 h-4 text-emerald-500`}):(0,g.jsx)(p,{className:`w-4 h-4 text-gray-400`}),(0,g.jsx)(`span`,{className:O.number?`text-emerald-700`:`text-gray-600`,children:n(`profile.req_number`,{defaultValue:`One number`})})]})]})]})]}),(0,g.jsxs)(`div`,{className:`space-y-2`,children:[(0,g.jsxs)(`label`,{className:`block text-sm font-medium text-gray-700`,children:[n(`profile.confirm_new_password`,{defaultValue:`Confirm New Password`}),` `,`*`]}),(0,g.jsxs)(`div`,{className:`relative`,children:[(0,g.jsx)(c,{className:`absolute left-3 top-3.5 w-5 h-5 text-gray-400 pointer-events-none`}),(0,g.jsx)(`input`,{type:y.confirm?`text`:`password`,name:`confirm`,value:s.confirm,onChange:T,required:!0,placeholder:n(`profile.confirm_new_password_placeholder`,{defaultValue:`Re-enter your new password`}),className:`w-full rounded-xl border-2 pl-10 pr-12 py-3 focus:outline-none transition-colors ${s.confirm&&s.newPassword!==s.confirm?`border-red-300 focus:border-red-500`:`border-gray-200 focus:border-emerald-500`}`}),(0,g.jsx)(`button`,{type:`button`,onClick:()=>E(`confirm`),className:`absolute right-3 top-3.5 text-gray-400 hover:text-gray-600 transition-colors`,children:y.confirm?(0,g.jsx)(l,{className:`w-5 h-5`}):(0,g.jsx)(d,{className:`w-5 h-5`})})]}),s.confirm&&s.newPassword!==s.confirm&&(0,g.jsxs)(`p`,{className:`text-sm text-red-600 flex items-center gap-1 slide-in`,children:[(0,g.jsx)(p,{className:`w-4 h-4`}),n(`profile.passwords_do_not_match`,{defaultValue:`Passwords do not match`})]}),s.confirm&&s.newPassword===s.confirm&&(0,g.jsxs)(`p`,{className:`text-sm text-emerald-600 flex items-center gap-1 slide-in`,children:[(0,g.jsx)(e,{className:`w-4 h-4`}),n(`profile.passwords_match`,{defaultValue:`Passwords match`})]})]}),C&&(0,g.jsx)(`div`,{className:`p-3 bg-red-50 border border-red-100 rounded-md text-sm text-red-700`,children:C}),(0,g.jsxs)(`div`,{className:`flex items-center justify-end gap-4 pt-4 border-t`,children:[(0,g.jsx)(`button`,{type:`button`,onClick:()=>window.history.back(),className:`px-6 py-3 rounded-xl text-gray-700 font-medium hover:bg-gray-100 transition-colors`,children:n(`common.cancel`)}),(0,g.jsx)(`button`,{type:`submit`,disabled:_||!k||s.newPassword!==s.confirm||!s.currentPassword,className:`px-6 py-3 rounded-xl text-white font-medium shadow-lg transition-all bg-gradient-to-r from-emerald-500 to-sky-600 hover:from-sky-600 hover:to-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed`,children:_?(0,g.jsxs)(`span`,{className:`flex items-center gap-2`,children:[(0,g.jsxs)(`svg`,{className:`animate-spin h-5 w-5`,viewBox:`0 0 24 24`,children:[(0,g.jsx)(`circle`,{className:`opacity-25`,cx:`12`,cy:`12`,r:`10`,stroke:`currentColor`,strokeWidth:`4`,fill:`none`}),(0,g.jsx)(`path`,{className:`opacity-75`,fill:`currentColor`,d:`M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z`})]}),n(`common.loading`)]}):n(`profile.update_password_cta`,{defaultValue:`Update Password`})})]})]})})]})]})}export{_ as default};