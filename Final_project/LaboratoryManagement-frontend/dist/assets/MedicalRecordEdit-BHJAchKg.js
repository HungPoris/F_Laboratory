import{t as e}from"./calendar-aV5gGbf_.js";import{t}from"./chevron-down-5citax4K.js";import{t as n}from"./clipboard-list-CdGJzdwV.js";import{t as r}from"./message-square-CCLenbod.js";import{A as i,D as a,G as o,O as s,S as c,W as l,Y as u,p as d,tt as f,x as p}from"./index-BK-GGJM4.js";var m=c(`save`,[[`path`,{d:`M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z`,key:`1c8476`}],[`path`,{d:`M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7`,key:`1ydtos`}],[`path`,{d:`M7 3v4a1 1 0 0 0 1 1h7`,key:`t51u73`}]]),h=f(u(),1),g=f(l(),1),_=f(i(),1),v=`https://be2.flaboratory.cloud`;function y(){let{patientId:i,recordId:c}=s(),l=a(),u=[`Internal Medicine`,`Surgery`,`Cardiology`,`ENT`,`Pediatrics`,`Dermatology`],f=(0,h.useRef)(null),[y,b]=(0,h.useState)(!1),[x,S]=(0,h.useState)({recordCode:``,visitDate:``,diagnosis:``,chiefComplaint:``,departments:[],clinicalNotes:``}),[C,w]=(0,h.useState)({}),[T,E]=(0,h.useState)(!0),D=async(e,t={})=>{let n=localStorage.getItem(`lm.access`);return o({url:`${v}${e}`,...t,headers:{Authorization:n?`Bearer ${n}`:void 0,"Content-Type":`application/json`,...t.headers}})};(0,h.useEffect)(()=>{k()},[i,c]),(0,h.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&b(!1)};return document.addEventListener(`mousedown`,e),()=>document.removeEventListener(`mousedown`,e)},[]);let O=e=>Array.isArray(e.departments)?e.departments:typeof e.department==`string`?e.department.split(`,`).map(e=>e.trim()):[],k=async()=>{try{let e=(await D(`/api/v1/patients/${i}/medical-records/${c}`)).data,t=O(e);S({recordCode:e.recordCode||``,visitDate:e.visitDate?e.visitDate.substring(0,16):``,diagnosis:e.diagnosis||``,chiefComplaint:e.chiefComplaint||``,departments:t,clinicalNotes:typeof e.clinicalNotes==`string`?e.clinicalNotes:e.clinicalNotes?.note||``})}catch{g.default.fire(`Error`,`Failed to load medical record.`,`error`)}finally{E(!1)}},A=e=>{S(t=>({...t,departments:t.departments.includes(e)?t.departments.filter(t=>t!==e):[...t.departments,e]}))},j=e=>({note:e}),M=()=>{let e={};return x.departments.length===0&&(e.departments=`Please select at least one department`),w(e),Object.keys(e).length===0};return T?(0,_.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-gradient-to-br from-emerald-50 via-sky-50 to-indigo-50`,children:(0,_.jsxs)(`div`,{className:`text-center`,children:[(0,_.jsx)(`div`,{className:`inline-block w-12 h-12 border-4 border-emerald-200 border-t-emerald-600 rounded-full animate-spin mb-4`}),(0,_.jsx)(`p`,{className:`text-gray-700 font-medium`,children:`Loading medical record...`})]})}):(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(`div`,{className:`min-h-screen bg-gradient-to-br from-emerald-50 via-sky-50 to-indigo-50 p-6`,children:[(0,_.jsxs)(`button`,{onClick:()=>l(`/patients/${i}/medical-records/${c}`),className:`inline-flex items-center gap-2 text-gray-600 hover:text-emerald-600 mb-6`,children:[(0,_.jsx)(p,{className:`w-5 h-5`}),`Back`]}),(0,_.jsxs)(`div`,{className:`bg-white p-8 rounded-3xl shadow-xl`,children:[(0,_.jsxs)(`div`,{className:`flex items-center gap-3 mb-8`,children:[(0,_.jsx)(`div`,{className:`p-3 rounded-2xl bg-gradient-to-br from-emerald-500 to-sky-600`,children:(0,_.jsx)(m,{className:`w-8 h-8 text-white`})}),(0,_.jsxs)(`div`,{children:[(0,_.jsx)(`h1`,{className:`text-3xl font-bold bg-gradient-to-r from-emerald-600 to-sky-600 bg-clip-text text-transparent`,children:`Edit Medical Record`}),(0,_.jsx)(`p`,{className:`text-sm text-gray-500 mt-1`,children:`Update record details below`})]})]}),(0,_.jsxs)(`form`,{onSubmit:async e=>{if(e.preventDefault(),M())try{await D(`/api/v1/patients/${i}/medical-records/${c}`,{method:`PUT`,data:{...x,departments:x.departments,clinicalNotes:j(x.clinicalNotes)}}),g.default.fire(`Success`,`Record updated successfully!`,`success`),l(`/patients/${i}/medical-records/${c}`)}catch(e){g.default.fire(`Error`,e.response?.data?.message||`Failed to update record.`,`error`)}},className:`space-y-6`,children:[(0,_.jsxs)(`div`,{children:[(0,_.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-2`,children:`Record Code`}),(0,_.jsx)(`input`,{value:x.recordCode,disabled:!0,className:`w-full rounded-xl border-2 border-gray-200 bg-gray-100 px-4 py-3`})]}),(0,_.jsxs)(`div`,{children:[(0,_.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-2`,children:`Visit Date`}),(0,_.jsxs)(`div`,{className:`relative`,children:[(0,_.jsx)(e,{className:`absolute left-3 top-3.5 w-5 h-5 text-gray-400 pointer-events-none`}),(0,_.jsx)(`input`,{type:`datetime-local`,name:`visitDate`,value:x.visitDate,onChange:e=>S(t=>({...t,visitDate:e.target.value})),className:`w-full rounded-xl border-2 border-emerald-200 pl-10 pr-4 py-3 focus:border-emerald-500 focus:outline-none transition-colors`})]})]}),(0,_.jsxs)(`div`,{children:[(0,_.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-2`,children:`Diagnosis`}),(0,_.jsxs)(`div`,{className:`relative`,children:[(0,_.jsx)(n,{className:`absolute left-3 top-3.5 w-5 h-5 text-gray-400 pointer-events-none`}),(0,_.jsx)(`input`,{name:`diagnosis`,value:x.diagnosis,onChange:e=>S(t=>({...t,diagnosis:e.target.value})),className:`w-full rounded-xl border-2 border-emerald-200 pl-10 pr-4 py-3 focus:border-emerald-500 focus:outline-none transition-colors`,placeholder:`Enter diagnosis...`})]})]}),(0,_.jsxs)(`div`,{children:[(0,_.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-2`,children:`Chief Complaint`}),(0,_.jsxs)(`div`,{className:`relative`,children:[(0,_.jsx)(r,{className:`absolute left-3 top-3.5 w-5 h-5 text-gray-400 pointer-events-none`}),(0,_.jsx)(`input`,{name:`chiefComplaint`,value:x.chiefComplaint,onChange:e=>S(t=>({...t,chiefComplaint:e.target.value})),className:`w-full rounded-xl border-2 border-emerald-200 pl-10 pr-4 py-3 focus:border-emerald-500 focus:outline-none transition-colors`,placeholder:`Enter chief complaint...`})]})]}),(0,_.jsxs)(`div`,{ref:f,children:[(0,_.jsxs)(`label`,{className:`block text-sm font-medium text-gray-700 mb-2`,children:[`Departments `,(0,_.jsx)(`span`,{className:`text-red-500`,children:`*`})]}),(0,_.jsxs)(`button`,{type:`button`,onClick:()=>b(e=>!e),className:`w-full border-2 rounded-xl px-4 py-3 text-left flex items-center gap-2 hover:border-emerald-400 transition-colors ${C.departments?`border-red-400`:`border-emerald-200`}`,children:[(0,_.jsx)(r,{className:`w-5 h-5 text-gray-400`}),(0,_.jsx)(`span`,{className:`text-gray-700`,children:x.departments.length===0?`Select departments`:`${x.departments.length} selected`}),(0,_.jsx)(t,{className:`ml-auto text-gray-500`})]}),y&&(0,_.jsxs)(`div`,{className:`mt-2 bg-white border-2 border-emerald-200 rounded-2xl shadow-lg p-4 max-h-[300px] overflow-y-auto z-50`,children:[(0,_.jsx)(`h3`,{className:`font-semibold mb-2`,children:`Departments`}),u.map(e=>(0,_.jsxs)(`label`,{className:`flex items-center gap-2 py-1 cursor-pointer hover:bg-emerald-50 rounded px-2 transition-colors`,children:[(0,_.jsx)(`input`,{type:`checkbox`,checked:x.departments.includes(e),onChange:()=>A(e),className:`accent-emerald-500`}),(0,_.jsx)(`span`,{children:e})]},e))]}),C.departments&&(0,_.jsx)(`p`,{className:`text-red-500 text-sm mt-2`,children:C.departments})]}),(0,_.jsxs)(`div`,{className:`flex flex-col gap-2 mt-3`,children:[x.chiefComplaint.trim()!==``&&(0,_.jsxs)(`span`,{className:`px-3 py-2 rounded-xl font-medium border-2 border-emerald-200 text-gray-800 bg-emerald-50`,children:[(0,_.jsx)(`b`,{children:`Chief Complaint:`}),` `,x.chiefComplaint]}),x.departments.length>0&&(0,_.jsxs)(`span`,{className:`px-3 py-2 rounded-xl font-medium border-2 border-sky-200 text-gray-800 bg-sky-50`,children:[(0,_.jsx)(`b`,{children:`Departments:`}),` `,x.departments.join(`, `)]})]}),(0,_.jsxs)(`div`,{children:[(0,_.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-2`,children:`Clinical Notes`}),(0,_.jsxs)(`div`,{className:`relative`,children:[(0,_.jsx)(d,{className:`absolute left-3 top-3.5 w-5 h-5 text-gray-400 pointer-events-none`}),(0,_.jsx)(`textarea`,{name:`clinicalNotes`,rows:`4`,value:x.clinicalNotes,onChange:e=>S(t=>({...t,clinicalNotes:e.target.value})),className:`w-full rounded-xl border-2 border-emerald-200 pl-10 pr-4 py-3 resize-none focus:border-emerald-500 focus:outline-none transition-colors`,placeholder:`Enter clinical notes...`})]})]}),(0,_.jsxs)(`div`,{className:`flex justify-end gap-4 pt-6 border-t`,children:[(0,_.jsx)(`button`,{type:`button`,onClick:()=>l(`/patients/${i}/medical-records/${c}`),className:`px-6 py-3 rounded-xl border-2 border-gray-200 hover:bg-gray-50 transition-all`,children:`Cancel`}),(0,_.jsxs)(`button`,{type:`submit`,className:`px-8 py-3 rounded-xl text-white font-medium shadow-lg bg-gradient-to-r from-emerald-500 to-sky-600 hover:from-sky-600 hover:to-emerald-500 flex items-center gap-2 transition-all`,children:[(0,_.jsx)(m,{className:`w-5 h-5`}),`Save Changes`]})]})]})]})]})})}export{y as default};