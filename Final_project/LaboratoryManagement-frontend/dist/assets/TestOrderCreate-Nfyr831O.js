import{t as e}from"./clipboard-list-CdGJzdwV.js";import{A as t,D as n,E as r,G as i,S as a,W as o,Y as s,c,tt as l,x as u}from"./index-BK-GGJM4.js";import{t as d}from"./testorderApi-BYvcba2f.js";var f=a(`list-checks`,[[`path`,{d:`M13 5h8`,key:`a7qcls`}],[`path`,{d:`M13 12h8`,key:`h98zly`}],[`path`,{d:`M13 19h8`,key:`c3s6r1`}],[`path`,{d:`m3 17 2 2 4-4`,key:`1jhpwq`}],[`path`,{d:`m3 7 2 2 4-4`,key:`1obspn`}]]),p=a(`stethoscope`,[[`path`,{d:`M11 2v2`,key:`1539x4`}],[`path`,{d:`M5 2v2`,key:`1yf1q8`}],[`path`,{d:`M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1`,key:`rb5t3r`}],[`path`,{d:`M8 15a6 6 0 0 0 12 0v-3`,key:`x18d4x`}],[`circle`,{cx:`20`,cy:`10`,r:`2`,key:`ts1r5v`}]]),m=l(s(),1),h=l(o(),1),g=l(t(),1),_=`https://be2.flaboratory.cloud`;function v(){let t=n(),{state:a}=r(),{medicalRecordId:o,patientId:s,patientName:l,age:v,gender:y,phoneNumber:b,email:x,address:S,dateOfBirth:C}=a||{},[w,T]=(0,m.useState)({priority:`NORMAL`}),[E,D]=(0,m.useState)(!1),[O,k]=(0,m.useState)([]),[A,j]=(0,m.useState)(!1),[M,N]=(0,m.useState)([]);(0,m.useEffect)(()=>{P()},[]);let P=async()=>{try{j(!0);let e=localStorage.getItem(`lm.access`),t=await i.get(`${_}/api/v1/test-types`,{headers:{Authorization:e?`Bearer ${e}`:void 0}});k(Array.isArray(t.data)?t.data:t.data?.content||t.data?.items||[])}catch(e){console.error(`Error loading test types:`,e),h.default.fire(`Error`,`Failed to load test types.`,`error`)}finally{j(!1)}},F=e=>{let{name:t,value:n}=e.target;T(e=>({...e,[t]:n}))},I=e=>{N(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},L=async e=>{if(e.preventDefault(),!o){h.default.fire(`Error`,`Missing medical record id.`,`error`);return}if(M.length===0){h.default.fire(`Missing Tests`,`Please select at least one test type.`,`warning`);return}let n=`TO-${Date.now()}`,r={patientId:s,patientName:l,age:v,gender:y,phoneNumber:b,email:x,address:S,dateOfBirth:C},i={orderNumber:n,medicalRecordId:o,priority:w.priority,testTypeIds:M,patientSnapshot:r};try{D(!0),await d(i),h.default.fire({icon:`success`,title:`Success`,text:`Test order created successfully!`,timer:1500,showConfirmButton:!1}),t(`/patients/${s}/medical-records/${o}`,{replace:!0})}catch(e){let t=e.response?.data?.message||e.response?.data?.error||`Failed to create test order`;h.default.fire(`Error`,t,`error`)}finally{D(!1)}},R=()=>t(-1),z=({label:e,value:t,isTextArea:n=!1})=>(0,g.jsxs)(`div`,{children:[(0,g.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-2`,children:e}),n?(0,g.jsx)(`textarea`,{value:t||``,readOnly:!0,rows:2,className:`w-full rounded-xl border-2 border-gray-200 bg-gray-50\r
        px-4 py-3 text-gray-700 resize-none focus:outline-none cursor-default`}):(0,g.jsx)(`input`,{type:`text`,value:t||``,readOnly:!0,className:`w-full rounded-xl border-2 border-gray-200 bg-gray-50\r
        px-4 py-3 text-gray-700 focus:outline-none cursor-default`})]});return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(`style`,{children:`
        @keyframes fade-in {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .fade-in { animation: fade-in 0.5s ease-out; }
      `}),(0,g.jsx)(`div`,{className:`min-h-screen bg-gradient-to-br from-emerald-50 via-sky-50 to-indigo-50 p-6`,children:(0,g.jsxs)(`div`,{className:`max-w-7xl mx-auto`,children:[(0,g.jsxs)(`button`,{onClick:R,className:`inline-flex items-center gap-2 text-gray-600 hover:text-emerald-600 font-medium mb-6 transition-colors`,children:[(0,g.jsx)(u,{className:`w-5 h-5`}),`Back to Medical Record`]}),(0,g.jsxs)(`div`,{className:`bg-white rounded-3xl shadow-xl p-8 fade-in`,children:[(0,g.jsxs)(`div`,{className:`flex items-center gap-3 mb-8`,children:[(0,g.jsx)(`div`,{className:`p-3 rounded-2xl bg-gradient-to-br from-emerald-500 to-sky-600`,children:(0,g.jsx)(e,{className:`w-8 h-8 text-white`})}),(0,g.jsxs)(`div`,{children:[(0,g.jsx)(`h1`,{className:`text-3xl font-bold bg-gradient-to-r from-emerald-600 to-sky-600 bg-clip-text text-transparent`,children:`Create Test Order`}),(0,g.jsxs)(`p`,{className:`text-sm text-gray-500 mt-1`,children:[`Medical Record ID: `,o||`N/A`]})]})]}),(0,g.jsxs)(`form`,{onSubmit:L,className:`space-y-8`,children:[(0,g.jsxs)(`section`,{className:`space-y-4`,children:[(0,g.jsxs)(`h3`,{className:`text-lg font-semibold text-gray-700 flex items-center gap-2 pt-6 border-t -mt-6`,children:[(0,g.jsx)(c,{className:`w-5 h-5 text-emerald-500`}),`Patient Information Snapshot`]}),(0,g.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-6`,children:[(0,g.jsx)(z,{label:`Full Name`,value:l}),(0,g.jsx)(z,{label:`Age`,value:v??``}),(0,g.jsx)(z,{label:`Gender`,value:y}),(0,g.jsx)(z,{label:`Phone Number`,value:b}),(0,g.jsx)(z,{label:`Email`,value:x}),(0,g.jsx)(z,{label:`Date of Birth`,value:C?new Date(C).toLocaleDateString():``}),(0,g.jsx)(`div`,{className:`md:col-span-2`,children:(0,g.jsx)(z,{label:`Address`,value:S,isTextArea:!0})})]})]}),(0,g.jsxs)(`section`,{className:`space-y-4 pt-6 border-t`,children:[(0,g.jsxs)(`h3`,{className:`text-lg font-semibold text-gray-700 flex items-center gap-2`,children:[(0,g.jsx)(p,{className:`w-5 h-5 text-sky-500`}),`Order Details`]}),(0,g.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-6`,children:(0,g.jsxs)(`div`,{children:[(0,g.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-2`,children:`Priority`}),(0,g.jsxs)(`select`,{name:`priority`,value:w.priority,onChange:F,className:`w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-emerald-500 focus:outline-none transition`,children:[(0,g.jsx)(`option`,{value:`URGENT`,children:`URGENT`}),(0,g.jsx)(`option`,{value:`HIGH`,children:`HIGH`}),(0,g.jsx)(`option`,{value:`LOW`,children:`LOW`}),(0,g.jsx)(`option`,{value:`NORMAL`,children:`NORMAL`})]})]})})]}),(0,g.jsxs)(`section`,{className:`space-y-4 pt-6 border-t`,children:[(0,g.jsxs)(`h3`,{className:`text-lg font-semibold text-gray-700 flex items-center gap-2`,children:[(0,g.jsx)(f,{className:`w-5 h-5 text-indigo-500`}),`Select Test Types`]}),A?(0,g.jsx)(`p`,{className:`text-gray-500`,children:`Loading test types...`}):O.length===0?(0,g.jsx)(`p`,{className:`text-gray-500`,children:`No test types available.`}):(0,g.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-3 max-h-64 overflow-y-auto border border-gray-200 rounded-xl p-4`,children:O.map(e=>(0,g.jsxs)(`label`,{className:`flex items-center gap-3 cursor-pointer p-1 hover:bg-emerald-50 rounded-lg transition`,children:[(0,g.jsx)(`input`,{type:`checkbox`,checked:M.includes(e.id),onChange:()=>I(e.id),className:`w-5 h-5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500`}),(0,g.jsxs)(`span`,{className:`text-gray-700`,children:[(0,g.jsx)(`strong`,{children:e.code||e.testTypeCode}),` â€”`,` `,e.name||e.testTypeName]})]},e.id))})]}),(0,g.jsxs)(`div`,{className:`flex justify-end gap-4 pt-6 border-t`,children:[(0,g.jsx)(`button`,{type:`button`,onClick:R,className:`px-6 py-3 rounded-xl border-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50 transition-all font-medium`,children:`Cancel`}),(0,g.jsxs)(`button`,{type:`submit`,disabled:E,className:`px-8 py-3 rounded-xl text-white font-medium shadow-lg bg-gradient-to-r from-emerald-500 to-sky-600 hover:from-sky-600 hover:to-emerald-500 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2`,children:[(0,g.jsx)(e,{className:`w-5 h-5`}),E?`Creating...`:`Create Test Order`]})]})]})]})]})})]})}export{v as default};