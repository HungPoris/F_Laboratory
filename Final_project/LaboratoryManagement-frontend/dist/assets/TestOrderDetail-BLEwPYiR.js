import{t as e}from"./CommentModal-DElnGMeh.js";import"./loader-circle-CGh2Y_RS.js";import{t}from"./message-square-CCLenbod.js";import{n,t as r}from"./trash-2-D1o_3E3w.js";import{A as i,D as a,G as o,O as s,S as c,W as l,Y as u,_ as d,tt as f,v as p}from"./index-BK-GGJM4.js";import{i as m,n as ee,o as h,r as te}from"./testorderApi-BYvcba2f.js";var g=c(`history`,[[`path`,{d:`M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8`,key:`1357e3`}],[`path`,{d:`M3 3v5h5`,key:`1xhq8a`}],[`path`,{d:`M12 7v5l4 2`,key:`1fdv2h`}]]),_=f(l(),1),v=f(u(),1),y=`https://be2.flaboratory.cloud`,b=()=>localStorage.getItem(`lm.access`),x=o.create({baseURL:y,withCredentials:!0});x.interceptors.request.use(e=>{let t=b();return t&&(e.headers=e.headers||{},e.headers.Authorization=`Bearer ${t}`),e});const S=async e=>(await x.get(`/api/v1/test-results/by-item/${e}`)).data,ne=async e=>(await x.post(`/api/v1/test-results`,e)).data,re=async(e,t)=>(await x.put(`/api/v1/test-results/${e}`,t)).data;var C=f(i(),1),w=`https://be2.flaboratory.cloud`;function ie({open:e,onClose:t,order:n,onAdded:r}){let[i,a]=(0,v.useState)([]),[s,c]=(0,v.useState)(!1),[l,u]=(0,v.useState)([]),d=new Set(n.items.map(e=>e.testTypeId));(0,v.useEffect)(()=>{e&&f()},[e]);let f=async()=>{try{c(!0);let e=localStorage.getItem(`lm.access`),t=await o.get(`${w}/api/v1/test-types`,{headers:{Authorization:e?`Bearer ${e}`:void 0},withCredentials:!0});a(Array.isArray(t.data)?t.data:[])}catch{_.default.fire(`Error`,`Failed to load test types`,`error`)}finally{c(!1)}},p=e=>{u(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return e?(0,C.jsx)(`div`,{className:`\r
        fixed inset-0 z-50 flex justify-center items-center\r
        backdrop-blur-sm bg-white/20\r
        transition-all duration-300\r
      `,children:(0,C.jsxs)(`div`,{className:`\r
          bg-white rounded-xl shadow-xl p-6 w-full max-w-lg\r
          animate-fadeIn\r
        `,style:{animation:`fadeIn 0.2s ease-out`},children:[(0,C.jsx)(`h2`,{className:`text-xl font-semibold mb-4`,children:`Add Test Items`}),s?(0,C.jsx)(`p`,{children:`Loading...`}):(0,C.jsx)(`div`,{className:`max-h-64 overflow-y-auto border rounded-lg p-3 space-y-2`,children:i.map(e=>{let t=d.has(e.id);return(0,C.jsxs)(`label`,{className:`flex items-center gap-2 text-sm`,children:[(0,C.jsx)(`input`,{type:`checkbox`,disabled:t,checked:l.includes(e.id),onChange:()=>p(e.id),className:`rounded border-gray-300`}),(0,C.jsxs)(`span`,{className:t?`text-gray-400`:`text-gray-800`,children:[(0,C.jsx)(`strong`,{children:e.code}),` - `,e.name,t&&(0,C.jsx)(`span`,{className:`ml-1 text-xs text-red-400`,children:`(already added)`})]})]},e.id)})}),(0,C.jsxs)(`div`,{className:`flex justify-end mt-4 gap-3`,children:[(0,C.jsx)(`button`,{className:`px-4 py-2 border rounded-lg`,onClick:t,children:`Cancel`}),(0,C.jsx)(`button`,{onClick:async()=>{if(l.length===0){_.default.fire(`Missing`,`Please select at least one test type`,`warning`);return}try{let e=localStorage.getItem(`lm.access`),i={testTypeIds:l};await o.post(`${w}/api/v1/test-orders/${n.id}/add-items`,i,{headers:{Authorization:e?`Bearer ${e}`:void 0},withCredentials:!0}),_.default.fire(`Success`,`Items added`,`success`),r(),t()}catch(e){console.error(e),_.default.fire(`Error`,e.response?.data?.message||`Failed`,`error`)}},className:`px-5 py-2 bg-cyan-600 text-white rounded-lg`,children:`Add Items`})]})]})}):null}function ae({open:e,onClose:t,itemId:n}){let[r,i]=(0,v.useState)(!1),[a,o]=(0,v.useState)(null);return(0,v.useEffect)(()=>{!e||!n||(async()=>{try{i(!0);let e=await S(n);o(e&&e.length>0?e[0]:null)}catch(e){console.error(`Failed to load result`,e),o(null)}finally{i(!1)}})()},[e,n]),e?(0,C.jsxs)(`div`,{className:`fixed inset-0 bg-black/20 backdrop-blur-sm flex justify-center items-center z-50 animate-fadeIn`,children:[(0,C.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-2xl p-7 w-full max-w-lg transform animate-slideUp`,children:[(0,C.jsx)(`h2`,{className:`text-2xl font-bold text-gray-800 mb-4`,children:`ðŸ§ª Test Result Detail`}),r?(0,C.jsx)(`div`,{className:`py-10 flex justify-center`,children:(0,C.jsx)(`div`,{className:`animate-spin h-10 w-10 border-4 border-cyan-300 border-t-cyan-600 rounded-full`})}):a?(0,C.jsxs)(`div`,{className:`space-y-3 text-sm text-gray-700`,children:[(0,C.jsxs)(`div`,{className:`flex justify-between`,children:[(0,C.jsx)(`span`,{className:`font-semibold`,children:`Test Type:`}),(0,C.jsx)(`span`,{children:a.testTypeName})]}),(0,C.jsxs)(`div`,{className:`flex justify-between`,children:[(0,C.jsx)(`span`,{className:`font-semibold`,children:`Instrument:`}),(0,C.jsx)(`span`,{children:a.instrumentName})]}),(0,C.jsxs)(`div`,{className:`flex justify-between`,children:[(0,C.jsx)(`span`,{className:`font-semibold`,children:`Reagent:`}),(0,C.jsx)(`span`,{children:a.reagentName})]}),(0,C.jsxs)(`div`,{className:`flex justify-between`,children:[(0,C.jsx)(`span`,{className:`font-semibold`,children:`Result Value:`}),(0,C.jsxs)(`span`,{className:`font-medium text-cyan-700`,children:[a.resultValue,` `,a.resultUnit]})]}),a.referenceRangeMin!==null&&(0,C.jsxs)(`div`,{className:`flex justify-between`,children:[(0,C.jsx)(`span`,{className:`font-semibold`,children:`Reference Range:`}),(0,C.jsxs)(`span`,{children:[a.referenceRangeMin,` - `,a.referenceRangeMax]})]}),(0,C.jsxs)(`div`,{className:`flex justify-between`,children:[(0,C.jsx)(`span`,{className:`font-semibold`,children:`Flag:`}),(0,C.jsx)(`span`,{className:`px-3 py-1 rounded-lg text-xs font-bold
                ${a.flagType===`HIGH`?`bg-red-100 text-red-700`:a.flagType===`LOW`?`bg-amber-100 text-amber-700`:`bg-emerald-100 text-emerald-700`}`,children:a.flagType||`NORMAL`})]}),(0,C.jsxs)(`div`,{className:`flex justify-between`,children:[(0,C.jsx)(`span`,{className:`font-semibold`,children:`Processed At:`}),(0,C.jsx)(`span`,{children:a.processedAt?new Date(a.processedAt).toLocaleString():`N/A`})]})]}):(0,C.jsx)(`div`,{className:`text-center text-gray-500 py-10`,children:`No result available for this test.`}),(0,C.jsx)(`div`,{className:`mt-6 flex justify-end`,children:(0,C.jsx)(`button`,{onClick:t,className:`px-5 py-2 bg-cyan-600 hover:bg-teal-600 text-white rounded-lg shadow-md transition`,children:`Close`})})]}),(0,C.jsx)(`style`,{children:`
        @keyframes fadeIn {
          from { opacity: 0 }
          to { opacity: 1 }
        }
        @keyframes slideUp {
          from { transform: translateY(20px); opacity: 0 }
          to { transform: translateY(0); opacity: 1 }
        }
        .animate-fadeIn { animation: fadeIn .2s ease-out }
        .animate-slideUp { animation: slideUp .25s ease-out }
      `})]}):null}var T=f(l(),1),oe=e=>{if(!e)return null;if(typeof e==`object`)return e;try{return JSON.parse(e)}catch(e){return console.error(`Error parsing snapshot:`,e),null}};function E(){let{id:i}=s(),o=a(),c=i,[l,u]=(0,v.useState)(null),[f,_]=(0,v.useState)(!1),[y,b]=(0,v.useState)({}),[x,w]=(0,v.useState)(!0),[E,D]=(0,v.useState)(!1),[O,k]=(0,v.useState)({}),[se,A]=(0,v.useState)(!1),[ce,j]=(0,v.useState)(!1),[le,ue]=(0,v.useState)(null),[M,de]=(0,v.useState)(!0),[fe,pe]=(0,v.useState)(`ALL`),[N,P]=(0,v.useState)([]),[me,F]=(0,v.useState)(null),[he,I]=(0,v.useState)(!1),[L,ge]=(0,v.useState)(null),[_e,ve]=(0,v.useState)(`testOrder`),[R,z]=(0,v.useState)({}),B=async e=>{try{let t=await S(e);return t&&t.length>0?t[0].resultValue:null}catch(t){return console.error(`Failed to fetch result for item ${e}:`,t),null}},V=async()=>{try{w(!0);let e=await m(c);u(e),P(e.items??[]),b({priority:e.priority,status:e.status});let t={},n=e.items.filter(e=>e.status===`COMPLETED`);for(let e of n){let n=await B(e.id);t[e.id]=n}z(t)}catch(e){let t=e.response?.data?.message||e.message||`Failed to load test order`;T.default.fire(`Error`,t,`error`)}finally{w(!1)}};(0,v.useEffect)(()=>{V()},[c]);let H=l?.status===`PENDING`,U=l?.status===`IN_PROGRESS`,W=l?.status===`COMPLETED`,G=l?.status===`CANCELLED`,ye=l?.items?.length>0&&l.items.every(e=>e.status===`COMPLETED`),K=l?oe(l.medicalRecordSnapshot):null,q=e=>{let{name:t,value:n}=e.target;b(e=>({...e,[t]:n}))},be=async()=>{try{let e={...l,priority:y.priority,status:y.status};u(await h(l.id,e)),_(!1),T.default.fire(`Success`,`Test order updated`,`success`)}catch{T.default.fire(`Error`,`Failed to update test order`,`error`)}},xe=async()=>{if((await T.default.fire({icon:`question`,title:`Confirm Order Completion`,text:`All test items are completed. Do you want to mark the order as COMPLETED?`,showCancelButton:!0,confirmButtonColor:`#10b981`,cancelButtonColor:`#6b7280`,confirmButtonText:`Yes, complete it`})).isConfirmed)try{u(await h(l.id,{...l,status:`COMPLETED`})),T.default.fire({icon:`success`,title:`Order Completed`,text:`The test order is now marked as COMPLETED.`})}catch{T.default.fire(`Error`,`Failed to update order status`,`error`)}},J=async e=>{if(H&&(e.target.blur(),(await T.default.fire({title:`Start Analysis?`,text:`The order is currently PENDING. Do you want to switch status to IN PROGRESS to enter results?`,icon:`info`,showCancelButton:!0,confirmButtonText:`Yes, Start`,confirmButtonColor:`#0ea5e9`})).isConfirmed))try{let e={...l,status:`IN_PROGRESS`};u(await h(l.id,e)),T.default.fire(`Updated`,`Order is now IN PROGRESS. You can enter results.`,`success`)}catch{T.default.fire(`Error`,`Failed to update status`,`error`)}},Se=async()=>{if((await T.default.fire({title:`Delete Test Order?`,text:`This action cannot be undone.`,icon:`warning`,showCancelButton:!0,confirmButtonColor:`#ef4444`,cancelButtonColor:`#6b7280`,confirmButtonText:`Yes, delete it`})).isConfirmed)try{await ee(l.id),await T.default.fire(`Deleted!`,`Test order deleted.`,`success`),o(`/patients/${l.patientId}/medical-records/${l.medicalRecordId}`)}catch(e){console.error(`Failed to delete test order`,e),T.default.fire(`Error`,e.response?.data?.message||`Failed to delete test order`,`error`)}},Ce=async e=>{if((await T.default.fire({title:`Delete Test Item?`,text:`This action cannot be undone.`,icon:`warning`,showCancelButton:!0,confirmButtonColor:`#ef4444`,cancelButtonColor:`#6b7280`,confirmButtonText:`Yes, delete it`})).isConfirmed)try{await te(e),T.default.fire(`Deleted!`,`Test item removed.`,`success`),await V()}catch{T.default.fire(`Error`,`Failed to delete item`,`error`)}},we=async()=>{try{D(!0);let e=await m(c);u(e),P(e.items??[]);let t={},n=e.items.filter(e=>e.status===`COMPLETED`);for(let e of n){let n=await B(e.id);t[e.id]=n}z(t),T.default.fire({icon:`success`,title:`Refreshed!`,timer:1e3,showConfirmButton:!1})}catch{T.default.fire(`Error`,`Failed to refresh items`,`error`)}finally{D(!1)}},Te=e=>{ue(e),j(!0)},Ee=(e,t=`testResult`)=>{ge(e),ve(t),I(!0)},De=async e=>{let t=O[e];if(!t){T.default.fire(`Warning`,`Please enter a value`,`warning`);return}try{await ne({testOrderItemId:e,resultValue:Number(t)}),await V(),k(t=>({...t,[e]:``})),F(null)}catch(e){T.default.fire(`Error`,e.response?.data?.message||`Failed to create result`,`error`)}},Oe=e=>{if(e.status===`COMPLETED`&&U){F(e.id);let t=R[e.id]||``;k(n=>({...n,[e.id]:t}))}},ke=e=>{k(t=>({...t,[e]:``})),F(null)},Y=async e=>{let t=O[e.id];if(t===void 0||t===``){T.default.fire(`Warning`,`Please enter a value`,`warning`);return}try{let n=await S(e.id);if(!n||n.length===0){T.default.fire(`Error`,`Result not found for this item`,`error`);return}let r=n[0].id;await re(r,{resultValue:Number(t)}),await V(),k(t=>({...t,[e.id]:``})),F(null)}catch(e){T.default.fire(`Error`,e.response?.data?.message||`Failed to update result`,`error`)}};if(x)return(0,C.jsx)(`div`,{className:`flex items-center justify-center min-h-screen bg-gradient-to-br from-cyan-50 via-blue-50 to-teal-50`,children:(0,C.jsxs)(`div`,{className:`text-center`,children:[(0,C.jsx)(`div`,{className:`inline-block animate-spin rounded-full h-16 w-16 border-4 border-cyan-200 border-t-cyan-600 mb-4`}),(0,C.jsx)(`p`,{className:`text-gray-700 font-medium`,children:`Loading test order...`})]})});if(!l)return(0,C.jsx)(`div`,{className:`min-h-screen flex items-center justify-center`,children:(0,C.jsxs)(`div`,{className:`text-center`,children:[(0,C.jsx)(`p`,{className:`text-gray-700 mb-3`,children:`Test order not found`}),(0,C.jsx)(`button`,{onClick:()=>o(`/lab-manager/testorders`),className:`text-cyan-600 hover:text-teal-600 font-medium`,children:`â† Back to Test Orders`})]})});let X=!U&&!W&&!G,Z=H,Q=!W&&!G,$=U;return(0,C.jsxs)(`div`,{className:`min-h-screen bg-gradient-to-br from-cyan-50 via-blue-50 to-teal-50`,children:[(0,C.jsxs)(`div`,{className:`container mx-auto px-6 py-8`,children:[(0,C.jsxs)(`button`,{onClick:()=>o(`/patients/${l.patientId}/medical-records/${l.medicalRecordId}`),className:`inline-flex items-center text-cyan-600 hover:text-teal-600 font-medium mb-5`,children:[(0,C.jsx)(`svg`,{className:`w-5 h-5 mr-2`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,C.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M10 19l-7-7m0 0l7-7m-7 7h18`})}),`Back to Medical Record`]}),(0,C.jsx)(`div`,{className:`bg-white rounded-lg shadow-md p-6 border-l-4 border-cyan-500 mb-8`,children:(0,C.jsxs)(`div`,{className:`flex justify-between items-center`,children:[(0,C.jsxs)(`h1`,{className:`text-3xl font-bold text-gray-800`,children:[`Test Order `,l.orderNumber||l.id]}),(0,C.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,C.jsxs)(`button`,{disabled:!X,onClick:()=>X&&_(e=>!e),className:`inline-flex items-center gap-2 px-5 py-2 rounded-md font-medium transition
                  ${X?`bg-teal-50 text-teal-600 hover:bg-teal-100`:`bg-gray-300 text-gray-500 cursor-not-allowed`}
                `,children:[(0,C.jsx)(n,{className:`w-5 h-5`}),f?`Cancel`:`Edit`]}),(0,C.jsxs)(`button`,{disabled:U,onClick:U?void 0:Se,className:`inline-flex items-center gap-2 px-5 py-2 rounded-md font-medium
                  ${U?`bg-gray-300 text-gray-400 cursor-not-allowed`:`bg-red-50 text-red-600 hover:bg-red-100`}
                  `,children:[(0,C.jsx)(`svg`,{className:`w-5 h-5`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,C.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M19 7l-.867 12.142A2 2 0\r
                    0116.138 21H7.862a2 2 0\r
                    01-1.995-1.858L5\r
                    7m5 4v6m4-6v6m1-10V4a1 1 0\r
                    00-1-1H9a1 1 0 00-1 1v3M4 7h16`})}),`Delete`]})]})]})}),(0,C.jsxs)(`div`,{className:`bg-white rounded-lg shadow-md p-6 mb-8 border-l-4 border-cyan-500`,children:[(0,C.jsx)(`h2`,{className:`text-xl font-semibold text-gray-800 mb-4 border-b pb-2`,children:`Order Information`}),(0,C.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-3 gap-4 text-sm`,children:[(0,C.jsxs)(`div`,{children:[(0,C.jsx)(`div`,{className:`text-gray-500 mb-1`,children:`Status`}),f?(0,C.jsxs)(`select`,{name:`status`,value:y.status,onChange:q,className:`w-full border rounded-lg px-3 py-2`,children:[(0,C.jsx)(`option`,{value:`PENDING`,children:`PENDING`}),(0,C.jsx)(`option`,{value:`IN_PROGRESS`,children:`IN PROGRESS`}),(0,C.jsx)(`option`,{value:`COMPLETED`,children:`COMPLETED`}),(0,C.jsx)(`option`,{value:`CANCELLED`,children:`CANCELLED`})]}):(0,C.jsx)(`span`,{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold
                    ${l.status===`PENDING`?`bg-slate-200 text-slate-700`:l.status===`IN_PROGRESS`?`bg-blue-200 text-blue-800`:l.status===`COMPLETED`?`bg-emerald-200 text-emerald-800`:`bg-red-200 text-red-800`}
                  `,children:l.status})]}),(0,C.jsxs)(`div`,{children:[(0,C.jsx)(`div`,{className:`text-gray-500 mb-1`,children:`Priority`}),f?(0,C.jsxs)(`select`,{name:`priority`,value:y.priority,onChange:q,className:`w-full border rounded-lg px-3 py-2`,children:[(0,C.jsx)(`option`,{value:`NORMAL`,children:`NORMAL`}),(0,C.jsx)(`option`,{value:`URGENT`,children:`URGENT`}),(0,C.jsx)(`option`,{value:`STAT`,children:`STAT`})]}):(0,C.jsx)(`span`,{className:`inline-flex items-center px-3 py-1 rounded-full font-semibold
                    ${l.priority===`STAT`?`bg-red-100 text-red-700`:l.priority===`URGENT`?`bg-amber-100 text-amber-700`:`bg-emerald-100 text-emerald-700`}
                  `,children:l.priority})]}),(0,C.jsxs)(`div`,{children:[(0,C.jsx)(`div`,{className:`text-gray-500 mb-1`,children:`Created At`}),(0,C.jsx)(`div`,{className:`font-medium text-gray-800`,children:l.createdAt?new Date(l.createdAt).toLocaleString():`N/A`})]}),(0,C.jsxs)(`div`,{className:`md:col-span-3 border-t pt-4 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm`,children:[(0,C.jsxs)(`div`,{children:[(0,C.jsx)(`div`,{className:`text-gray-500 mb-1`,children:`Patient`}),(0,C.jsx)(`div`,{className:`font-medium text-gray-800`,children:l.patientName||`N/A`})]}),(0,C.jsxs)(`div`,{children:[(0,C.jsx)(`div`,{className:`text-gray-500 mb-1`,children:`Age / Gender`}),(0,C.jsxs)(`div`,{className:`font-medium text-gray-800`,children:[l.age??`N/A`,` / `,l.gender||`N/A`]})]}),(0,C.jsxs)(`div`,{children:[(0,C.jsx)(`div`,{className:`text-gray-500 mb-1`,children:`Phone`}),(0,C.jsx)(`div`,{className:`font-medium text-gray-800`,children:l.phoneNumber||`N/A`})]})]})]}),f&&(0,C.jsx)(`div`,{className:`flex justify-end mt-4`,children:(0,C.jsx)(`button`,{onClick:be,className:`px-5 py-2 rounded-md text-white font-semibold bg-gradient-to-r from-cyan-500 to-teal-500`,children:`Save Changes`})}),K&&(0,C.jsx)(`div`,{className:`mt-8 border-t border-dashed border-gray-300 pt-6`,children:(0,C.jsxs)(`div`,{className:`bg-purple-50 rounded-lg p-5 border border-purple-200`,children:[(0,C.jsxs)(`div`,{className:`flex items-center gap-2 mb-3`,children:[(0,C.jsx)(g,{className:`w-5 h-5 text-purple-600`}),(0,C.jsx)(`h3`,{className:`text-lg font-semibold text-gray-800`,children:`Medical Record Snapshot`}),(0,C.jsx)(`span`,{className:`text-xs text-gray-500 font-normal`,children:`(Captured at time of order)`})]}),(0,C.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 text-sm`,children:[[`Record Code`,K.recordCode],[`Visit Date`,K.visitDate?new Date(K.visitDate).toLocaleString():`N/A`],[`Diagnosis`,K.diagnosis],[`Chief Complaint`,K.chiefComplaint],[`Prescriptions`,K.prescriptions],[`Attending Physician`,K.attendingPhysician]].map(([e,t])=>t&&(0,C.jsxs)(`div`,{children:[(0,C.jsx)(`label`,{className:`block text-xs font-semibold text-purple-700 mb-0.5`,children:e}),(0,C.jsx)(`p`,{className:`text-gray-900 font-medium whitespace-pre-wrap`,children:t})]},e))}),(0,C.jsxs)(`div`,{className:`mt-4 pt-3 border-t border-purple-100 text-xs text-purple-600 italic flex items-center`,children:[(0,C.jsx)(`svg`,{className:`w-3 h-3 mr-1.5`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,C.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z`})}),`Historical data. Updates to original record are not reflected here.`]})]})})]}),(0,C.jsxs)(`div`,{className:`bg-white rounded-lg shadow-md p-6 border-l-4 border-cyan-500`,children:[(0,C.jsxs)(`div`,{className:`flex items-center justify-between mb-6`,children:[(0,C.jsx)(`h2`,{className:`text-xl font-semibold text-gray-800`,children:`Test Order Items`}),(0,C.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,C.jsxs)(`button`,{disabled:!Z,onClick:()=>Z&&A(!0),title:Z?``:`You can only add items when the order is PENDING`,className:`inline-flex items-center gap-2 px-5 py-2 rounded-md font-medium transition-all duration-200
                  ${Z?`bg-gradient-to-r from-cyan-500 to-teal-500 text-white hover:from-cyan-600 hover:to-teal-600 shadow-md`:`bg-gray-300 text-gray-500 cursor-not-allowed`}
                `,children:[(0,C.jsx)(`svg`,{className:`w-5 h-5`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,C.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M12 4v16m8-8H4`})}),`Add Item`]}),ye&&!W&&!G&&(0,C.jsxs)(`button`,{onClick:xe,className:`inline-flex items-center gap-2 px-5 py-2 rounded-md font-semibold shadow-md\r
                    bg-emerald-500 text-white hover:bg-emerald-600 transition`,children:[(0,C.jsx)(`svg`,{className:`w-5 h-5`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,C.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M5 13l4 4L19 7`})}),`Confirm Complete`]}),(0,C.jsxs)(`button`,{disabled:!Q,onClick:Q?we:void 0,className:`inline-flex items-center gap-2 px-5 py-2 rounded-md border font-medium
                    ${Q?`border-cyan-500 text-cyan-700 hover:bg-cyan-50`:`text-gray-400 border-gray-300 cursor-not-allowed`}
                `,children:[(0,C.jsx)(`svg`,{className:`w-5 h-5`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,C.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11\r
                    11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15`})}),`Refresh`]})]})]}),E?(0,C.jsx)(`div`,{className:`py-10 text-center`,children:(0,C.jsx)(`div`,{className:`inline-block animate-spin h-8 w-8 border-b-2 border-cyan-600 rounded-full`})}):!l.items||l.items.length===0?(0,C.jsx)(`div`,{className:`text-center text-gray-500 py-12`,children:`No items added yet.`}):(0,C.jsx)(`div`,{className:`overflow-x-auto`,children:(0,C.jsxs)(`table`,{className:`min-w-full divide-y divide-gray-200`,children:[(0,C.jsx)(`thead`,{className:`bg-gray-50`,children:(0,C.jsxs)(`tr`,{children:[(0,C.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase`,children:`Test Code`}),(0,C.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase`,children:`Test Name`}),(0,C.jsxs)(`th`,{className:`px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase cursor-pointer select-none`,onClick:()=>{let e={PENDING:1,IN_PROGRESS:2,COMPLETED:3},t=[...N].sort((t,n)=>M?e[t.status]-e[n.status]:e[n.status]-e[t.status]);de(!M),u({...l,items:t})},children:[`Status `,M?`â–²`:`â–¼`]}),(0,C.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase`,children:`Result`}),(0,C.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase`,children:(0,C.jsxs)(`select`,{className:`border rounded-md px-2 py-1 text-xs bg-white`,value:fe,onChange:e=>{let t=e.target.value;if(pe(t),t===`ALL`){u({...l,items:N});return}let n={};if(t===`HIGH`&&(n={HIGH:1,NORMAL:2,LOW:3}),t===`NORMAL`&&(n={NORMAL:1,HIGH:2,LOW:3}),t===`LOW`&&(n={LOW:1,NORMAL:2,HIGH:3}),!N.some(e=>e.flagType===t)){T.default.fire({icon:`error`,title:`No results found`,text:`There are no test items with result: ${t}`,confirmButtonColor:`#ef4444`});return}let r=[...N].sort((e,t)=>(n[e.flagType]||99)-(n[t.flagType]||99));u({...l,items:r})},children:[(0,C.jsx)(`option`,{value:`ALL`,children:`Flag`}),(0,C.jsx)(`option`,{value:`HIGH`,children:`High First`}),(0,C.jsx)(`option`,{value:`NORMAL`,children:`Normal First`}),(0,C.jsx)(`option`,{value:`LOW`,children:`Low First`})]})}),(0,C.jsx)(`th`,{className:`px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase`,children:`Actions`})]})}),(0,C.jsx)(`tbody`,{className:`bg-white divide-y divide-gray-100`,children:l.items.map(e=>{let i=me===e.id,a=e.status===`COMPLETED`;return(0,C.jsxs)(`tr`,{className:`hover:bg-cyan-50 transition-colors`,children:[(0,C.jsx)(`td`,{className:`px-6 py-4 text-sm font-semibold`,children:e.testTypeCode}),(0,C.jsx)(`td`,{className:`px-6 py-4 text-sm`,children:e.testTypeName}),(0,C.jsx)(`td`,{className:`px-6 py-4`,children:(0,C.jsx)(`span`,{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold
                              ${e.status===`COMPLETED`?`bg-emerald-100 text-emerald-700`:e.status===`IN_PROGRESS`?`bg-blue-100 text-blue-700`:`bg-slate-100 text-slate-700`}
                            `,children:e.status})}),(0,C.jsx)(`td`,{className:`px-6 py-4`,children:a&&!i?(0,C.jsx)(`span`,{className:`px-2 py-1 text-sm font-medium text-gray-800`,children:R[e.id]!==null&&R[e.id]!==void 0?R[e.id]:`N/A`}):(0,C.jsx)(`input`,{type:`number`,placeholder:`Value`,disabled:G||W,readOnly:!U,onClick:a?void 0:J,onFocus:a?void 0:J,value:O[e.id]||``,onChange:t=>{U&&k(n=>({...n,[e.id]:t.target.value}))},onKeyDown:t=>{t.key===`Enter`&&U&&(i?Y(e):a||De(e.id))},className:`w-24 px-2 py-1 border rounded-md text-sm transition-colors
                                ${U?`bg-white border-gray-300`:`bg-gray-100 cursor-pointer`}
                              `})}),(0,C.jsx)(`td`,{className:`px-6 py-4`,children:e.status===`COMPLETED`?(0,C.jsx)(`span`,{className:`px-2 py-1 rounded-full text-xs font-semibold
                                ${e.flagType===`HIGH`?`bg-red-100 text-red-700`:e.flagType===`LOW`?`bg-amber-100 text-amber-700`:`bg-emerald-100 text-emerald-700`}
                              `,children:e.flagType||`NORMAL`}):(0,C.jsx)(`span`,{className:`text-xs text-gray-500`,children:`N/A`})}),(0,C.jsx)(`td`,{className:`px-6 py-4`,children:(0,C.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,C.jsx)(`button`,{onClick:()=>Te(e.id),className:`p-2 rounded-lg hover:bg-cyan-50 hover:scale-110 transition`,title:`View`,children:(0,C.jsxs)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,className:`w-5 h-5 text-gray-500 hover:text-cyan-600`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`,strokeWidth:2,children:[(0,C.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,d:`M15 12a3 3 0 11-6 0 3 3 0 016 0z`}),(0,C.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,d:`M2.458 12C3.732 7.943 7.523 5 12 5s8.268 2.943 9.542 7c-1.274 4.057-5.065 7-9.542 7S3.732 16.057 2.458 12z`})]})}),H&&(0,C.jsx)(`button`,{onClick:()=>Ce(e.id),className:`p-2 rounded-lg hover:bg-red-50 hover:scale-110 transition`,title:`Delete`,children:(0,C.jsx)(r,{className:`w-5 h-5 text-red-600 hover:text-red-700`})}),a&&!i&&(0,C.jsx)(`button`,{onClick:()=>Oe(e),disabled:!$,className:`p-2 rounded-lg transition ${$?`hover:bg-amber-50 hover:scale-110`:`opacity-40 cursor-not-allowed`}`,title:`Edit Result`,children:(0,C.jsx)(n,{className:`w-5 h-5 text-gray-500 hover:text-amber-600`})}),i&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(`button`,{onClick:()=>Y(e),className:`p-2 rounded-lg text-emerald-500 hover:bg-emerald-50 hover:scale-110`,title:`Save Result`,children:(0,C.jsx)(p,{className:`w-5 h-5`})}),(0,C.jsx)(`button`,{onClick:()=>ke(e.id),className:`p-2 rounded-lg text-red-500 hover:bg-red-50 hover:scale-110`,title:`Cancel Edit`,children:(0,C.jsx)(d,{className:`w-5 h-5`})})]}),(0,C.jsx)(`button`,{onClick:()=>Ee(e.id,`testResult`),disabled:G,className:`p-2 rounded-lg transition ${G?`opacity-40 cursor-not-allowed`:`hover:bg-yellow-50 hover:scale-110`}`,title:`Comment`,children:(0,C.jsx)(t,{className:`w-5 h-5 text-gray-500 hover:text-yellow-600`})})]})})]},e.id)})})]})})]})]}),(0,C.jsx)(ie,{open:se,onClose:()=>A(!1),order:l,onAdded:()=>V()}),(0,C.jsx)(ae,{open:ce,onClose:()=>j(!1),itemId:le}),(0,C.jsx)(e,{open:he,onClose:()=>I(!1),itemId:L,itemType:_e})]})}export{E as default};